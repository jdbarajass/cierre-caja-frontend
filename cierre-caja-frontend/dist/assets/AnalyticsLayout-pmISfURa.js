import{l as e,b as s,j as a,a as t}from"./index-CruezJMO.js";import{r,u as l}from"./react-vendor-BQCAaWH2.js";import{g as d}from"./dateUtils-DNdQ6mri.js";import{f as n,A as c,c as i,C as o,U as x,q as m,R as h,T as p,r as g,D as u,F as b,s as j,i as y,B as N,t as v}from"./icons-BheYzHFb.js";const f=5e4,_=()=>{var t,l,u,b;const j=d(),y=j.substring(0,8)+"01",[N,v]=r.useState(null),[_,w]=r.useState(!1),[C,k]=r.useState(null),[S,E]=r.useState({start_date:y,end_date:j}),T=async()=>{if(S.start_date&&S.end_date){w(!0),k(null);try{const a=await(async(a={})=>{try{const t=new URLSearchParams;a.date&&t.append("date",a.date),a.start_date&&t.append("start_date",a.start_date),a.end_date&&t.append("end_date",a.end_date);const r=t.toString(),l="/api/analytics/dashboard"+(r?`?${r}`:"");e.info("Obteniendo dashboard completo:",a);const d=await s(l,{method:"GET"},f);if(!d.ok){const e=await d.json().catch(()=>({}));throw new Error(e.error||"Error al obtener dashboard")}return await d.json()}catch(C){throw e.error("Error en getAnalyticsDashboard:",C),C}})(S);a.success?v(a.data):k(a.error||"Error al cargar el dashboard")}catch(a){k(a.message||"Error al conectar con el servidor")}finally{w(!1)}}else k("Por favor selecciona ambas fechas para consultar")};return _?a.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:a.jsxs("div",{className:"text-center max-w-md px-4",children:[a.jsx(n,{className:"w-12 h-12 animate-spin text-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-800 font-semibold mb-2",children:"Procesando an치lisis de ventas..."}),a.jsx("p",{className:"text-gray-600 text-sm",children:"Esto puede tardar hasta 50 segundos dependiendo de la cantidad de facturas."}),a.jsx("p",{className:"text-gray-500 text-xs mt-2",children:"Por favor espera..."})]})}):C?a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 text-red-800",children:[a.jsx(c,{className:"w-6 h-6"}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold",children:"Error al cargar datos"}),a.jsx("p",{className:"text-sm",children:C})]})]}),a.jsx("button",{onClick:T,className:"mt-4 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Reintentar"})]}):N?a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:a.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(i,{className:"w-5 h-5 text-gray-600"}),a.jsx("span",{className:"font-semibold text-gray-700",children:"Rango de Fechas:"})]}),a.jsx("input",{type:"date",value:S.start_date,onChange:e=>E(s=>({...s,start_date:e.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),a.jsx("span",{className:"text-gray-600",children:"hasta"}),a.jsx("input",{type:"date",value:S.end_date,onChange:e=>E(s=>({...s,end_date:e.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),a.jsx("button",{onClick:T,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Consultar Per칤odo"})]})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[N.peak_hours&&a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:a.jsx(o,{className:"w-6 h-6 text-blue-600"})}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Horas Pico"})]}),N.peak_hours.top_5_peak_hours&&N.peak_hours.top_5_peak_hours[0]&&a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"text-sm text-gray-600",children:"Mejor hora:"}),a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:N.peak_hours.top_5_peak_hours[0].hour_range}),a.jsx("div",{className:"text-sm text-gray-700",children:N.peak_hours.top_5_peak_hours[0].total_revenue_formatted}),a.jsxs("div",{className:"text-xs text-gray-500",children:[N.peak_hours.top_5_peak_hours[0].invoice_count," facturas"]})]})]}),N.top_customers&&a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:a.jsx(x,{className:"w-6 h-6 text-green-600"})}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Top Clientes"})]}),N.top_customers.summary&&a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"text-sm text-gray-600",children:"Total clientes:"}),a.jsx("div",{className:"text-2xl font-bold text-green-600",children:N.top_customers.summary.total_unique_customers}),a.jsxs("div",{className:"text-sm text-gray-700",children:["Recurrencia: ",null==(t=N.top_customers.summary.recurring_rate)?void 0:t.toFixed(1),"%"]}),a.jsx("div",{className:"text-xs text-gray-500",children:N.top_customers.summary.total_revenue_formatted})]})]}),N.top_sellers&&a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"p-3 bg-yellow-100 rounded-lg",children:a.jsx(m,{className:"w-6 h-6 text-yellow-600"})}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Top Vendedoras"})]}),N.top_sellers.top_sellers&&N.top_sellers.top_sellers[0]&&a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"text-sm text-gray-600",children:"Mejor vendedora:"}),a.jsx("div",{className:"text-lg font-bold text-yellow-600 truncate",children:N.top_sellers.top_sellers[0].seller_name}),a.jsx("div",{className:"text-sm text-gray-700",children:N.top_sellers.top_sellers[0].total_sales_formatted}),a.jsxs("div",{className:"text-xs text-gray-500",children:[N.top_sellers.top_sellers[0].invoice_count," facturas"]})]})]}),N.customer_retention&&a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:a.jsx(h,{className:"w-6 h-6 text-purple-600"})}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Retenci칩n"})]}),N.customer_retention.summary&&a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"text-sm text-gray-600",children:"Tasa de retenci칩n:"}),a.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[null==(l=N.customer_retention.summary.retention_rate)?void 0:l.toFixed(1),"%"]}),a.jsxs("div",{className:"text-sm text-gray-700",children:["Leales: ",N.customer_retention.summary.loyal_customers]}),a.jsxs("div",{className:"text-xs text-gray-500",children:["En riesgo: ",N.customer_retention.summary.at_risk_customers]})]})]}),N.sales_trends&&a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"p-3 bg-indigo-100 rounded-lg",children:a.jsx(p,{className:"w-6 h-6 text-indigo-600"})}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Tendencias"})]}),N.sales_trends.summary&&a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"text-sm text-gray-600",children:"Mejor d칤a:"}),a.jsx("div",{className:"text-lg font-bold text-indigo-600",children:null==(u=N.sales_trends.summary.best_day)?void 0:u.day_name}),a.jsx("div",{className:"text-sm text-gray-700",children:null==(b=N.sales_trends.summary.best_day)?void 0:b.total_revenue_formatted}),a.jsxs("div",{className:"text-xs text-gray-500",children:["Promedio: ",N.sales_trends.summary.avg_revenue_per_day_formatted]})]})]}),N.cross_selling&&a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"p-3 bg-pink-100 rounded-lg",children:a.jsx(g,{className:"w-6 h-6 text-pink-600"})}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Cross-Selling"})]}),N.cross_selling.summary&&a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"text-sm text-gray-600",children:"Combos encontrados:"}),a.jsx("div",{className:"text-2xl font-bold text-pink-600",children:N.cross_selling.summary.total_product_pairs}),N.cross_selling.top_product_pairs&&N.cross_selling.top_product_pairs[0]&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"text-sm text-gray-700",children:["Top combo: ",N.cross_selling.top_product_pairs[0].times_bought_together," veces"]}),a.jsx("div",{className:"text-xs text-gray-500 truncate",children:N.cross_selling.top_product_pairs[0].total_revenue_formatted})]})]})]})]}),a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:a.jsx("p",{className:"text-sm text-blue-800",children:"Selecciona cada secci칩n en el men칰 superior para ver el an치lisis completo con gr치ficos y tablas detalladas."})})]}):a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:a.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(i,{className:"w-5 h-5 text-gray-600"}),a.jsx("span",{className:"font-semibold text-gray-700",children:"Rango de Fechas:"})]}),a.jsx("input",{type:"date",value:S.start_date,onChange:e=>E(s=>({...s,start_date:e.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),a.jsx("span",{className:"text-gray-600",children:"hasta"}),a.jsx("input",{type:"date",value:S.end_date,onChange:e=>E(s=>({...s,end_date:e.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),a.jsx("button",{onClick:T,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Consultar Per칤odo"})]})}),a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-8 text-center",children:[a.jsx(i,{className:"w-16 h-16 text-blue-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-2",children:"Selecciona un per칤odo para consultar"}),a.jsx("p",{className:"text-blue-700",children:'Elige la fecha de inicio y fecha de fin, luego presiona "Consultar Per칤odo" para ver el an치lisis completo.'})]})]})},w=()=>{const t=d(),l=t.substring(0,8)+"01",[x,m]=r.useState(null),[h,p]=r.useState(!1),[g,j]=r.useState(null),[y,N]=r.useState({start_date:l,end_date:t}),v=async()=>{if(y.start_date&&y.end_date){p(!0),j(null);try{const a=await(async(a={})=>{try{const t=new URLSearchParams;a.date&&t.append("date",a.date),a.start_date&&t.append("start_date",a.start_date),a.end_date&&t.append("end_date",a.end_date);const r=t.toString(),l="/api/analytics/peak-hours"+(r?`?${r}`:"");e.info("Obteniendo horas pico:",a);const d=await s(l,{method:"GET"},f);if(!d.ok){const e=await d.json().catch(()=>({}));throw new Error(e.error||"Error al obtener horas pico")}return await d.json()}catch(g){throw e.error("Error en getPeakHours:",g),g}})(y);a.success?m(a.data):j(a.error||"Error al cargar datos")}catch(a){j(a.message||"Error al conectar con el servidor")}finally{p(!1)}}else j("Por favor selecciona ambas fechas para consultar")};return h?a.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:a.jsxs("div",{className:"text-center",children:[a.jsx(n,{className:"w-12 h-12 animate-spin text-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Cargando horas pico..."})]})}):g?a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 text-red-800",children:[a.jsx(c,{className:"w-6 h-6"}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold",children:"Error al cargar datos"}),a.jsx("p",{className:"text-sm",children:g})]})]}),a.jsx("button",{onClick:v,className:"mt-4 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Reintentar"})]}):x?a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:a.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(i,{className:"w-5 h-5 text-gray-600"}),a.jsx("span",{className:"font-semibold text-gray-700",children:"Rango de Fechas:"})]}),a.jsx("input",{type:"date",value:y.start_date,onChange:e=>N(s=>({...s,start_date:e.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),a.jsx("span",{className:"text-gray-600",children:"hasta"}),a.jsx("input",{type:"date",value:y.end_date,onChange:e=>N(s=>({...s,end_date:e.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),a.jsx("button",{onClick:v,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Consultar Per칤odo"})]})}),x.summary&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx(u,{className:"w-5 h-5 text-green-600"}),a.jsx("span",{className:"text-sm text-gray-600",children:"Total Ingresos"})]}),a.jsx("div",{className:"text-2xl font-bold text-gray-900",children:x.summary.total_revenue_formatted})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx(b,{className:"w-5 h-5 text-blue-600"}),a.jsx("span",{className:"text-sm text-gray-600",children:"Total Facturas"})]}),a.jsx("div",{className:"text-2xl font-bold text-gray-900",children:x.summary.total_invoices})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx(o,{className:"w-5 h-5 text-purple-600"}),a.jsx("span",{className:"text-sm text-gray-600",children:"Horas con Ventas"})]}),a.jsx("div",{className:"text-2xl font-bold text-gray-900",children:x.summary.hours_with_sales})]})]}),x.top_5_peak_hours&&x.top_5_peak_hours.length>0&&a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Top 5 Horas Pico"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:x.top_5_peak_hours.map((e,s)=>a.jsxs("div",{className:"border-2 rounded-lg p-4 "+(0===s?"border-yellow-400 bg-yellow-50":1===s?"border-gray-400 bg-gray-50":2===s?"border-orange-400 bg-orange-50":"border-gray-200 bg-white"),children:[a.jsx("div",{className:"text-center mb-2",children:a.jsx("span",{className:"text-3xl font-bold",children:0===s?"游볞":1===s?"游볟":2===s?"游볠":`#${s+1}`})}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-lg font-bold text-gray-900",children:e.hour_range}),a.jsx("div",{className:"text-sm font-semibold text-blue-600 mt-2",children:e.total_revenue_formatted}),a.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[e.invoice_count," facturas"]}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Ticket: ",e.average_ticket_formatted]})]})]},e.hour))})]}),x.daily_hourly_breakdown&&a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Ventas por D칤a de la Semana"}),a.jsx("div",{className:"space-y-4",children:Object.entries(x.daily_hourly_breakdown).map(([e,s])=>s.length>0&&a.jsxs("div",{className:"border-b border-gray-200 last:border-b-0 pb-4 last:pb-0",children:[a.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:e}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-2",children:s.slice(0,6).map(e=>a.jsxs("div",{className:"bg-gray-50 rounded p-2 text-sm",children:[a.jsx("div",{className:"font-semibold text-gray-700",children:e.hour_range}),a.jsx("div",{className:"text-xs text-blue-600",children:e.total_revenue_formatted}),a.jsxs("div",{className:"text-xs text-gray-500",children:[e.invoice_count," fact."]})]},e.hour))}),s.length>6&&a.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:["+",s.length-6," horas m치s"]})]},e))})]})]}):a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:a.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(i,{className:"w-5 h-5 text-gray-600"}),a.jsx("span",{className:"font-semibold text-gray-700",children:"Rango de Fechas:"})]}),a.jsx("input",{type:"date",value:y.start_date,onChange:e=>N(s=>({...s,start_date:e.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),a.jsx("span",{className:"text-gray-600",children:"hasta"}),a.jsx("input",{type:"date",value:y.end_date,onChange:e=>N(s=>({...s,end_date:e.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),a.jsx("button",{onClick:v,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Consultar Per칤odo"})]})}),a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-8 text-center",children:[a.jsx(o,{className:"w-16 h-16 text-blue-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-2",children:"Selecciona un per칤odo para consultar"}),a.jsx("p",{className:"text-blue-700",children:"Elige las fechas de inicio y fin para visualizar las horas pico de ventas"})]})]})},C=()=>{var t;const l=d(),o=l.substring(0,8)+"01",[m,h]=r.useState(null),[p,g]=r.useState(!1),[b,y]=r.useState(null),[N,v]=r.useState(10),[_,w]=r.useState({start_date:o,end_date:l}),C=async()=>{if(_.start_date&&_.end_date){g(!0),y(null);try{const a=await(async(a={})=>{try{const t=new URLSearchParams;a.date&&t.append("date",a.date),a.start_date&&t.append("start_date",a.start_date),a.end_date&&t.append("end_date",a.end_date),a.limit&&t.append("limit",a.limit.toString());const r=t.toString(),l="/api/analytics/top-customers"+(r?`?${r}`:"");e.info("Obteniendo top clientes:",a);const d=await s(l,{method:"GET"},f);if(!d.ok){const e=await d.json().catch(()=>({}));throw new Error(e.error||"Error al obtener top clientes")}return await d.json()}catch(b){throw e.error("Error en getTopCustomers:",b),b}})({..._,limit:N});a.success?h(a.data):y(a.error||"Error al cargar datos")}catch(a){y(a.message||"Error al conectar con el servidor")}finally{g(!1)}}else y("Por favor selecciona ambas fechas para consultar")};return p?a.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:a.jsxs("div",{className:"text-center",children:[a.jsx(n,{className:"w-12 h-12 animate-spin text-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Cargando top clientes..."})]})}):b?a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 text-red-800",children:[a.jsx(c,{className:"w-6 h-6"}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold",children:"Error al cargar datos"}),a.jsx("p",{className:"text-sm",children:b})]})]}),a.jsx("button",{onClick:C,className:"mt-4 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Reintentar"})]}):m?a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:a.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(i,{className:"w-5 h-5 text-gray-600"}),a.jsx("span",{className:"font-semibold text-gray-700",children:"Rango de Fechas:"})]}),a.jsx("input",{type:"date",value:_.start_date,onChange:e=>w(s=>({...s,start_date:e.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),a.jsx("span",{className:"text-gray-600",children:"hasta"}),a.jsx("input",{type:"date",value:_.end_date,onChange:e=>w(s=>({...s,end_date:e.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),a.jsxs("select",{value:N,onChange:e=>v(Number(e.target.value)),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:5,children:"Top 5"}),a.jsx("option",{value:10,children:"Top 10"}),a.jsx("option",{value:20,children:"Top 20"}),a.jsx("option",{value:50,children:"Top 50"})]})]})}),m.summary&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx(x,{className:"w-5 h-5 text-blue-600"}),a.jsx("span",{className:"text-sm text-gray-600",children:"Total Clientes"})]}),a.jsx("div",{className:"text-2xl font-bold text-gray-900",children:m.summary.total_unique_customers})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx(u,{className:"w-5 h-5 text-green-600"}),a.jsx("span",{className:"text-sm text-gray-600",children:"Total Ingresos"})]}),a.jsx("div",{className:"text-2xl font-bold text-gray-900",children:m.summary.total_revenue_formatted})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx(j,{className:"w-5 h-5 text-purple-600"}),a.jsx("span",{className:"text-sm text-gray-600",children:"Ticket Promedio"})]}),a.jsx("div",{className:"text-2xl font-bold text-gray-900",children:m.summary.average_customer_value_formatted})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx(x,{className:"w-5 h-5 text-orange-600"}),a.jsx("span",{className:"text-sm text-gray-600",children:"Recurrencia"})]}),a.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[null==(t=m.summary.recurring_rate)?void 0:t.toFixed(1),"%"]})]})]}),m.top_customers&&m.top_customers.length>0&&a.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsxs("h3",{className:"text-xl font-bold text-gray-900",children:["Top ",m.top_customers.length," Clientes"]})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rank"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cliente"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Gastado"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Compras"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ticket Prom."}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"칔ltima Compra"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tipo"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:m.top_customers.map((e,s)=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("span",{className:"font-bold "+(0===s?"text-yellow-600":1===s?"text-gray-400":2===s?"text-orange-600":"text-gray-600"),children:["#",s+1]})}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.customer_name}),a.jsx("div",{className:"text-xs text-gray-500",children:e.email||"Sin email"})]}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:"text-sm font-semibold text-green-600",children:e.total_spent_formatted})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.purchase_count}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.average_ticket_formatted}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.last_purchase_date}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full "+(e.purchase_count>=5?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"),children:e.purchase_count>=5?"VIP":"Regular"})})]},e.customer_id))})]})})]})]}):a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:a.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(i,{className:"w-5 h-5 text-gray-600"}),a.jsx("span",{className:"font-semibold text-gray-700",children:"Rango de Fechas:"})]}),a.jsx("input",{type:"date",value:_.start_date,onChange:e=>w(s=>({...s,start_date:e.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),a.jsx("span",{className:"text-gray-600",children:"hasta"}),a.jsx("input",{type:"date",value:_.end_date,onChange:e=>w(s=>({...s,end_date:e.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),a.jsxs("select",{value:N,onChange:e=>v(Number(e.target.value)),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:5,children:"Top 5"}),a.jsx("option",{value:10,children:"Top 10"}),a.jsx("option",{value:20,children:"Top 20"}),a.jsx("option",{value:50,children:"Top 50"})]}),a.jsx("button",{onClick:C,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Consultar Per칤odo"})]})}),a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-8 text-center",children:[a.jsx(x,{className:"w-16 h-16 text-blue-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-2",children:"Selecciona un per칤odo para consultar"}),a.jsx("p",{className:"text-blue-700",children:"Elige las fechas de inicio y fin para visualizar los mejores clientes"})]})]})},k=()=>{const t=d(),l=t.substring(0,8)+"01",[o,x]=r.useState(null),[h,p]=r.useState(!1),[g,b]=r.useState(null),[j,y]=r.useState(10),[N,v]=r.useState({start_date:l,end_date:t}),_=async()=>{if(N.start_date&&N.end_date){p(!0),b(null);try{const a=await(async(a={})=>{try{const t=new URLSearchParams;a.date&&t.append("date",a.date),a.start_date&&t.append("start_date",a.start_date),a.end_date&&t.append("end_date",a.end_date),a.limit&&t.append("limit",a.limit.toString());const r=t.toString(),l="/api/analytics/top-sellers"+(r?`?${r}`:"");e.info("Obteniendo top vendedoras:",a);const d=await s(l,{method:"GET"},f);if(!d.ok){const e=await d.json().catch(()=>({}));throw new Error(e.error||"Error al obtener top vendedoras")}return await d.json()}catch(g){throw e.error("Error en getTopSellers:",g),g}})({...N,limit:j});a.success?x(a.data):b(a.error||"Error al cargar datos")}catch(a){b(a.message||"Error al conectar con el servidor")}finally{p(!1)}}else b("Por favor selecciona ambas fechas para consultar")};return h?a.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:a.jsxs("div",{className:"text-center",children:[a.jsx(n,{className:"w-12 h-12 animate-spin text-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Cargando top vendedoras..."})]})}):g?a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 text-red-800",children:[a.jsx(c,{className:"w-6 h-6"}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold",children:"Error al cargar datos"}),a.jsx("p",{className:"text-sm",children:g})]})]}),a.jsx("button",{onClick:_,className:"mt-4 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Reintentar"})]}):o?a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:a.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(i,{className:"w-5 h-5 text-gray-600"}),a.jsx("span",{className:"font-semibold text-gray-700",children:"Rango de Fechas:"})]}),a.jsx("input",{type:"date",value:N.start_date,onChange:e=>v(s=>({...s,start_date:e.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),a.jsx("span",{className:"text-gray-600",children:"hasta"}),a.jsx("input",{type:"date",value:N.end_date,onChange:e=>v(s=>({...s,end_date:e.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),a.jsx("button",{onClick:_,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Consultar Per칤odo"})]})}),o.summary&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx(u,{className:"w-5 h-5 text-green-600"}),a.jsx("span",{className:"text-sm text-gray-600",children:"Total Ingresos"})]}),a.jsx("div",{className:"text-2xl font-bold text-gray-900",children:o.summary.total_revenue_formatted})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx(m,{className:"w-5 h-5 text-yellow-600"}),a.jsx("span",{className:"text-sm text-gray-600",children:"Promedio por Vendedora"})]}),a.jsx("div",{className:"text-2xl font-bold text-gray-900",children:o.summary.average_sales_per_seller_formatted})]})]}),o.top_sellers&&o.top_sellers.length>=3&&a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:"Podio de Vendedoras"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"bg-gradient-to-br from-yellow-100 to-yellow-50 rounded-lg p-6 border-2 border-yellow-400",children:[a.jsx("div",{className:"text-center mb-4",children:a.jsx("span",{className:"text-5xl",children:"游볞"})}),a.jsxs("div",{className:"text-center",children:[a.jsx("h4",{className:"font-bold text-gray-900 mb-2",children:o.top_sellers[0].seller_name}),a.jsx("div",{className:"text-2xl font-bold text-yellow-600 mb-2",children:o.top_sellers[0].total_sales_formatted}),a.jsxs("div",{className:"space-y-1 text-sm text-gray-700",children:[a.jsxs("div",{children:[o.top_sellers[0].invoice_count," facturas"]}),a.jsxs("div",{children:["Ticket: ",o.top_sellers[0].average_ticket_formatted]}),a.jsxs("div",{className:"text-xs text-gray-600",children:["Hora productiva: ",o.top_sellers[0].most_productive_hour]})]})]})]}),a.jsxs("div",{className:"bg-gradient-to-br from-gray-200 to-gray-50 rounded-lg p-6 border-2 border-gray-400",children:[a.jsx("div",{className:"text-center mb-4",children:a.jsx("span",{className:"text-5xl",children:"游볟"})}),a.jsxs("div",{className:"text-center",children:[a.jsx("h4",{className:"font-bold text-gray-900 mb-2",children:o.top_sellers[1].seller_name}),a.jsx("div",{className:"text-2xl font-bold text-gray-600 mb-2",children:o.top_sellers[1].total_sales_formatted}),a.jsxs("div",{className:"space-y-1 text-sm text-gray-700",children:[a.jsxs("div",{children:[o.top_sellers[1].invoice_count," facturas"]}),a.jsxs("div",{children:["Ticket: ",o.top_sellers[1].average_ticket_formatted]}),a.jsxs("div",{className:"text-xs text-gray-600",children:["Hora productiva: ",o.top_sellers[1].most_productive_hour]})]})]})]}),a.jsxs("div",{className:"bg-gradient-to-br from-orange-100 to-orange-50 rounded-lg p-6 border-2 border-orange-400",children:[a.jsx("div",{className:"text-center mb-4",children:a.jsx("span",{className:"text-5xl",children:"游볠"})}),a.jsxs("div",{className:"text-center",children:[a.jsx("h4",{className:"font-bold text-gray-900 mb-2",children:o.top_sellers[2].seller_name}),a.jsx("div",{className:"text-2xl font-bold text-orange-600 mb-2",children:o.top_sellers[2].total_sales_formatted}),a.jsxs("div",{className:"space-y-1 text-sm text-gray-700",children:[a.jsxs("div",{children:[o.top_sellers[2].invoice_count," facturas"]}),a.jsxs("div",{children:["Ticket: ",o.top_sellers[2].average_ticket_formatted]}),a.jsxs("div",{className:"text-xs text-gray-600",children:["Hora productiva: ",o.top_sellers[2].most_productive_hour]})]})]})]})]})]}),o.top_sellers&&o.top_sellers.length>0&&a.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Ranking Completo"})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Rank"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Vendedora"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Total Ventas"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Facturas"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Ticket Prom."}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Clientes 칔nicos"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Hora Productiva"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.top_sellers.map((e,s)=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("span",{className:"font-bold "+(0===s?"text-yellow-600":1===s?"text-gray-400":2===s?"text-orange-600":"text-gray-600"),children:["#",s+1]})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.seller_name})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:"text-sm font-semibold text-green-600",children:e.total_sales_formatted})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.invoice_count}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.average_ticket_formatted}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.unique_customers}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:e.most_productive_hour})]},e.seller_id))})]})})]})]}):a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:a.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(i,{className:"w-5 h-5 text-gray-600"}),a.jsx("span",{className:"font-semibold text-gray-700",children:"Rango de Fechas:"})]}),a.jsx("input",{type:"date",value:N.start_date,onChange:e=>v(s=>({...s,start_date:e.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),a.jsx("span",{className:"text-gray-600",children:"hasta"}),a.jsx("input",{type:"date",value:N.end_date,onChange:e=>v(s=>({...s,end_date:e.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),a.jsx("button",{onClick:_,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Consultar Per칤odo"})]})}),a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-8 text-center",children:[a.jsx(m,{className:"w-16 h-16 text-blue-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-2",children:"Selecciona un per칤odo para consultar"}),a.jsx("p",{className:"text-blue-700",children:"Elige las fechas de inicio y fin para visualizar el ranking de vendedoras"})]})]})},S=()=>{var t;const l=d(),o=l.substring(0,8)+"01",[x,m]=r.useState(null),[p,g]=r.useState(!1),[u,b]=r.useState(null),[j,y]=r.useState({start_date:o,end_date:l}),N=async()=>{if(j.start_date&&j.end_date){g(!0),b(null);try{const a=await(async(a={})=>{try{const t=new URLSearchParams;a.date&&t.append("date",a.date),a.start_date&&t.append("start_date",a.start_date),a.end_date&&t.append("end_date",a.end_date);const r=t.toString(),l="/api/analytics/customer-retention"+(r?`?${r}`:"");e.info("Obteniendo retenci칩n de clientes:",a);const d=await s(l,{method:"GET"},f);if(!d.ok){const e=await d.json().catch(()=>({}));throw new Error(e.error||"Error al obtener retenci칩n de clientes")}return await d.json()}catch(u){throw e.error("Error en getCustomerRetention:",u),u}})(j);a.success?m(a.data):b(a.error||"Error al cargar datos")}catch(a){b(a.message||"Error al conectar con el servidor")}finally{g(!1)}}else b("Por favor selecciona ambas fechas para consultar")};return p?a.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:a.jsxs("div",{className:"text-center",children:[a.jsx(n,{className:"w-12 h-12 animate-spin text-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Cargando retenci칩n de clientes..."})]})}):u?a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 text-red-800",children:[a.jsx(c,{className:"w-6 h-6"}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold",children:"Error al cargar datos"}),a.jsx("p",{className:"text-sm",children:u})]})]}),a.jsx("button",{onClick:N,className:"mt-4 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Reintentar"})]}):x?a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:a.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(i,{className:"w-5 h-5 text-gray-600"}),a.jsx("span",{className:"font-semibold text-gray-700",children:"Rango de Fechas:"})]}),a.jsx("input",{type:"date",value:j.start_date,onChange:e=>y(s=>({...s,start_date:e.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),a.jsx("span",{className:"text-gray-600",children:"hasta"}),a.jsx("input",{type:"date",value:j.end_date,onChange:e=>y(s=>({...s,end_date:e.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),a.jsx("button",{onClick:N,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Consultar Per칤odo"})]})}),x.summary&&a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:"Segmentaci칩n de Clientes"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[a.jsxs("div",{className:"bg-green-50 border-2 border-green-300 rounded-lg p-6 text-center",children:[a.jsx("h4",{className:"text-lg font-semibold text-green-800 mb-2",children:"Nuevos"}),a.jsx("div",{className:"text-4xl font-bold text-green-600 mb-2",children:x.summary.new_customers}),a.jsx("p",{className:"text-sm text-green-700",children:"1 compra"})]}),a.jsxs("div",{className:"bg-blue-50 border-2 border-blue-300 rounded-lg p-6 text-center",children:[a.jsx("h4",{className:"text-lg font-semibold text-blue-800 mb-2",children:"Recurrentes"}),a.jsx("div",{className:"text-4xl font-bold text-blue-600 mb-2",children:x.summary.recurring_customers}),a.jsx("p",{className:"text-sm text-blue-700",children:"2-4 compras"})]}),a.jsxs("div",{className:"bg-purple-50 border-2 border-purple-300 rounded-lg p-6 text-center",children:[a.jsx("h4",{className:"text-lg font-semibold text-purple-800 mb-2",children:"Leales"}),a.jsx("div",{className:"text-4xl font-bold text-purple-600 mb-2",children:x.summary.loyal_customers}),a.jsx("p",{className:"text-sm text-purple-700",children:"5+ compras"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"flex items-center gap-3 p-4 bg-green-50 rounded-lg",children:[a.jsx("div",{className:"w-4 h-4 bg-green-500 rounded-full"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-semibold text-gray-900",children:"Activos"}),a.jsx("div",{className:"text-2xl font-bold text-green-600",children:x.summary.active_customers})]})]}),a.jsxs("div",{className:"flex items-center gap-3 p-4 bg-yellow-50 rounded-lg",children:[a.jsx("div",{className:"w-4 h-4 bg-yellow-500 rounded-full"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-semibold text-gray-900",children:"En Riesgo"}),a.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:x.summary.at_risk_customers})]})]}),a.jsxs("div",{className:"flex items-center gap-3 p-4 bg-red-50 rounded-lg",children:[a.jsx("div",{className:"w-4 h-4 bg-red-500 rounded-full"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-semibold text-gray-900",children:"Inactivos"}),a.jsx("div",{className:"text-2xl font-bold text-red-600",children:x.summary.inactive_customers})]})]})]}),a.jsxs("div",{className:"mt-6 text-center",children:[a.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"Tasa de Retenci칩n"}),a.jsxs("div",{className:"text-5xl font-bold text-purple-600",children:[null==(t=x.summary.retention_rate)?void 0:t.toFixed(1),"%"]})]})]}),x.top_loyal_customers&&x.top_loyal_customers.length>0&&a.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Top Clientes Leales"})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Cliente"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Frecuencia"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Total Gastado"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"칔ltima Compra"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Estado"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x.top_loyal_customers.slice(0,10).map(e=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4",children:a.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.customer_name})}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[e.frequency," compras"]}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:"text-sm font-semibold text-green-600",children:e.monetary_formatted})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:e.last_purchase_date}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full "+("Activo"===e.activity_status?"bg-green-100 text-green-800":"En riesgo"===e.activity_status?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:e.activity_status})})]},e.customer_id))})]})})]}),x.at_risk_customers&&x.at_risk_customers.length>0&&a.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsxs("h3",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(c,{className:"w-5 h-5 text-yellow-600"}),"Clientes en Riesgo"]})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Cliente"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"D칤as Sin Comprar"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Total Gastado"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"칔ltima Compra"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x.at_risk_customers.slice(0,10).map(e=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4",children:a.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.customer_name})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("span",{className:"text-sm font-semibold text-yellow-600",children:[e.recency_days," d칤as"]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.monetary_formatted}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:e.last_purchase_date})]},e.customer_id))})]})})]})]}):a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:a.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(i,{className:"w-5 h-5 text-gray-600"}),a.jsx("span",{className:"font-semibold text-gray-700",children:"Rango de Fechas:"})]}),a.jsx("input",{type:"date",value:j.start_date,onChange:e=>y(s=>({...s,start_date:e.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),a.jsx("span",{className:"text-gray-600",children:"hasta"}),a.jsx("input",{type:"date",value:j.end_date,onChange:e=>y(s=>({...s,end_date:e.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),a.jsx("button",{onClick:N,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Consultar Per칤odo"})]})}),a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-8 text-center",children:[a.jsx(h,{className:"w-16 h-16 text-blue-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-2",children:"Selecciona un per칤odo para consultar"}),a.jsx("p",{className:"text-blue-700",children:"Elige las fechas de inicio y fin para visualizar la retenci칩n de clientes"})]})]})},E=()=>{var t,l,o,x,m,h;const g=d(),b=g.substring(0,8)+"01",[j,y]=r.useState(null),[N,v]=r.useState(!1),[_,w]=r.useState(null),[C,k]=r.useState({start_date:b,end_date:g}),S=async()=>{if(C.start_date&&C.end_date){v(!0),w(null);try{const a=await(async(a={})=>{try{const t=new URLSearchParams;a.date&&t.append("date",a.date),a.start_date&&t.append("start_date",a.start_date),a.end_date&&t.append("end_date",a.end_date);const r=t.toString(),l="/api/analytics/sales-trends"+(r?`?${r}`:"");e.info("Obteniendo tendencias de ventas:",a);const d=await s(l,{method:"GET"},f);if(!d.ok){const e=await d.json().catch(()=>({}));throw new Error(e.error||"Error al obtener tendencias de ventas")}return await d.json()}catch(_){throw e.error("Error en getSalesTrends:",_),_}})(C);a.success?y(a.data):w(a.error||"Error al cargar datos")}catch(a){w(a.message||"Error al conectar con el servidor")}finally{v(!1)}}else w("Por favor selecciona ambas fechas para consultar")};return N?a.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:a.jsxs("div",{className:"text-center",children:[a.jsx(n,{className:"w-12 h-12 animate-spin text-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Cargando tendencias..."})]})}):_?a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 text-red-800",children:[a.jsx(c,{className:"w-6 h-6"}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold",children:"Error al cargar datos"}),a.jsx("p",{className:"text-sm",children:_})]})]}),a.jsx("button",{onClick:S,className:"mt-4 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Reintentar"})]}):j?a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:a.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(i,{className:"w-5 h-5 text-gray-600"}),a.jsx("span",{className:"font-semibold text-gray-700",children:"Rango de Fechas:"})]}),a.jsx("input",{type:"date",value:C.start_date,onChange:e=>k(s=>({...s,start_date:e.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),a.jsx("span",{className:"text-gray-600",children:"hasta"}),a.jsx("input",{type:"date",value:C.end_date,onChange:e=>k(s=>({...s,end_date:e.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),a.jsx("button",{onClick:S,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Consultar Per칤odo"})]})}),j.summary&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx(u,{className:"w-5 h-5 text-green-600"}),a.jsx("span",{className:"text-sm text-gray-600",children:"Total Per칤odo"})]}),a.jsx("div",{className:"text-2xl font-bold text-gray-900",children:j.summary.total_revenue_formatted})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx(p,{className:"w-5 h-5 text-blue-600"}),a.jsx("span",{className:"text-sm text-gray-600",children:"Promedio Diario"})]}),a.jsx("div",{className:"text-2xl font-bold text-gray-900",children:j.summary.avg_revenue_per_day_formatted})]}),a.jsxs("div",{className:"bg-green-50 border-2 border-green-300 rounded-lg p-6",children:[a.jsx("div",{className:"text-sm text-green-700 mb-2",children:"Mejor D칤a"}),a.jsx("div",{className:"font-semibold text-green-900",children:null==(t=j.summary.best_day)?void 0:t.day_name}),a.jsx("div",{className:"text-xl font-bold text-green-600",children:null==(l=j.summary.best_day)?void 0:l.total_revenue_formatted}),a.jsx("div",{className:"text-xs text-green-700 mt-1",children:null==(o=j.summary.best_day)?void 0:o.date})]}),a.jsxs("div",{className:"bg-red-50 border-2 border-red-300 rounded-lg p-6",children:[a.jsx("div",{className:"text-sm text-red-700 mb-2",children:"Peor D칤a"}),a.jsx("div",{className:"font-semibold text-red-900",children:null==(x=j.summary.worst_day)?void 0:x.day_name}),a.jsx("div",{className:"text-xl font-bold text-red-600",children:null==(m=j.summary.worst_day)?void 0:m.total_revenue_formatted}),a.jsx("div",{className:"text-xs text-red-700 mt-1",children:null==(h=j.summary.worst_day)?void 0:h.date})]})]}),j.weekday_analysis&&a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"An치lisis por D칤a de la Semana"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-7 gap-2",children:j.weekday_analysis.map(e=>a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[a.jsx("div",{className:"font-semibold text-gray-900 mb-2",children:e.day_name}),a.jsx("div",{className:"text-lg font-bold text-blue-600 mb-1",children:e.avg_revenue_per_day_formatted}),a.jsxs("div",{className:"text-xs text-gray-600",children:[e.invoice_count," facturas"]}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[e.days_count," d칤as"]})]},e.day_name))})]}),j.daily_sales&&j.daily_sales.length>0&&a.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Ventas Diarias"})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Fecha"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"D칤a"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Total"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Facturas"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Ticket Prom."})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:j.daily_sales.map(e=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.date}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:e.day_name}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:"text-sm font-semibold text-green-600",children:e.total_revenue_formatted})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.invoice_count}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.average_ticket_formatted})]},e.date))})]})})]})]}):a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:a.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(i,{className:"w-5 h-5 text-gray-600"}),a.jsx("span",{className:"font-semibold text-gray-700",children:"Rango de Fechas:"})]}),a.jsx("input",{type:"date",value:C.start_date,onChange:e=>k(s=>({...s,start_date:e.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),a.jsx("span",{className:"text-gray-600",children:"hasta"}),a.jsx("input",{type:"date",value:C.end_date,onChange:e=>k(s=>({...s,end_date:e.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),a.jsx("button",{onClick:S,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Consultar Per칤odo"})]})}),a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-8 text-center",children:[a.jsx(p,{className:"w-16 h-16 text-blue-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-2",children:"Selecciona un per칤odo para consultar"}),a.jsx("p",{className:"text-blue-700",children:"Elige las fechas de inicio y fin para visualizar las tendencias de ventas"})]})]})},T=()=>{const t=d(),l=t.substring(0,8)+"01",[o,x]=r.useState(null),[m,h]=r.useState(!1),[p,b]=r.useState(null),[j,y]=r.useState(2),[N,v]=r.useState({start_date:l,end_date:t}),_=async()=>{if(N.start_date&&N.end_date){h(!0),b(null);try{const a=await(async(a={})=>{try{const t=new URLSearchParams;a.date&&t.append("date",a.date),a.start_date&&t.append("start_date",a.start_date),a.end_date&&t.append("end_date",a.end_date),a.min_support&&t.append("min_support",a.min_support.toString());const r=t.toString(),l="/api/analytics/cross-selling"+(r?`?${r}`:"");e.info("Obteniendo cross-selling:",a);const d=await s(l,{method:"GET"},f);if(!d.ok){const e=await d.json().catch(()=>({}));throw new Error(e.error||"Error al obtener cross-selling")}return await d.json()}catch(p){throw e.error("Error en getCrossSelling:",p),p}})({...N,min_support:j});a.success?x(a.data):b(a.error||"Error al cargar datos")}catch(a){b(a.message||"Error al conectar con el servidor")}finally{h(!1)}}else b("Por favor selecciona ambas fechas para consultar")};return m?a.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:a.jsxs("div",{className:"text-center",children:[a.jsx(n,{className:"w-12 h-12 animate-spin text-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Cargando an치lisis de cross-selling..."})]})}):p?a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 text-red-800",children:[a.jsx(c,{className:"w-6 h-6"}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold",children:"Error al cargar datos"}),a.jsx("p",{className:"text-sm",children:p})]})]}),a.jsx("button",{onClick:_,className:"mt-4 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Reintentar"})]}):o?a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:a.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(i,{className:"w-5 h-5 text-gray-600"}),a.jsx("span",{className:"font-semibold text-gray-700",children:"Rango de Fechas:"})]}),a.jsx("input",{type:"date",value:N.start_date,onChange:e=>v(s=>({...s,start_date:e.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),a.jsx("span",{className:"text-gray-600",children:"hasta"}),a.jsx("input",{type:"date",value:N.end_date,onChange:e=>v(s=>({...s,end_date:e.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("label",{className:"text-sm text-gray-700",children:"Soporte m칤nimo:"}),a.jsx("input",{type:"number",min:"1",max:"10",value:j,onChange:e=>y(Number(e.target.value)),className:"w-20 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),a.jsx("button",{onClick:_,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Consultar Per칤odo"})]})}),o.summary&&a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Resumen"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"flex items-center gap-3 p-4 bg-blue-50 rounded-lg",children:[a.jsx(g,{className:"w-8 h-8 text-blue-600"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm text-gray-600",children:"Combos Encontrados"}),a.jsx("div",{className:"text-3xl font-bold text-blue-600",children:o.summary.total_product_pairs})]})]}),a.jsxs("div",{className:"flex items-center gap-3 p-4 bg-purple-50 rounded-lg",children:[a.jsx(u,{className:"w-8 h-8 text-purple-600"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm text-gray-600",children:"Productos 칔nicos"}),a.jsx("div",{className:"text-3xl font-bold text-purple-600",children:o.summary.total_unique_products})]})]})]})]}),o.top_product_pairs&&o.top_product_pairs.length>0&&a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Top Productos que se Compran Juntos"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:o.top_product_pairs.map((e,s)=>{var t;return a.jsxs("div",{className:"border-2 border-gray-200 rounded-lg p-4 hover:border-blue-400 transition-colors",children:[a.jsx("div",{className:"text-center mb-3",children:a.jsxs("span",{className:"inline-block px-3 py-1 bg-blue-100 text-blue-800 font-semibold rounded-full text-sm",children:["#",s+1]})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900 truncate",title:e.product1,children:e.product1}),a.jsx("div",{className:"text-center text-2xl font-bold text-gray-400",children:"+"}),a.jsx("div",{className:"text-sm font-medium text-gray-900 truncate",title:e.product2,children:e.product2})]}),a.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 space-y-2",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-xs text-gray-600",children:"Comprados juntos:"}),a.jsxs("span",{className:"font-semibold text-blue-600",children:[e.times_bought_together," veces"]})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-xs text-gray-600",children:"Ingresos:"}),a.jsx("span",{className:"font-semibold text-green-600",children:e.total_revenue_formatted})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-xs text-gray-600",children:"Confianza:"}),a.jsxs("span",{className:"font-semibold text-purple-600",children:[null==(t=e.avg_confidence)?void 0:t.toFixed(1),"%"]})]})]})]},s)})})]}),o.top_product_pairs&&o.top_product_pairs.length>0&&a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:a.jsxs("p",{className:"text-sm text-blue-800",children:[a.jsx("strong",{children:"Sugerencia:"})," Estos pares de productos se compran frecuentemente juntos. Considera crear combos o promociones para incrementar las ventas."]})}),o.top_product_pairs&&0===o.top_product_pairs.length&&a.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6 text-center",children:a.jsxs("p",{className:"text-yellow-800",children:["No se encontraron pares de productos con el soporte m칤nimo de ",j,". Intenta reducir el soporte m칤nimo o ampliar el rango de fechas."]})})]}):a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:a.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(i,{className:"w-5 h-5 text-gray-600"}),a.jsx("span",{className:"font-semibold text-gray-700",children:"Rango de Fechas:"})]}),a.jsx("input",{type:"date",value:N.start_date,onChange:e=>v(s=>({...s,start_date:e.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),a.jsx("span",{className:"text-gray-600",children:"hasta"}),a.jsx("input",{type:"date",value:N.end_date,onChange:e=>v(s=>({...s,end_date:e.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("label",{className:"text-sm text-gray-700",children:"Soporte m칤nimo:"}),a.jsx("input",{type:"number",min:"1",max:"10",value:j,onChange:e=>y(Number(e.target.value)),className:"w-20 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),a.jsx("button",{onClick:_,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Consultar Per칤odo"})]})}),a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-8 text-center",children:[a.jsx(g,{className:"w-16 h-16 text-blue-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-2",children:"Selecciona un per칤odo para consultar"}),a.jsx("p",{className:"text-blue-700",children:"Elige las fechas de inicio y fin para visualizar productos que se compran juntos"})]})]})},P=()=>{const e=l(),[s,d]=r.useState("dashboard");t((()=>{switch(s){case"dashboard":return"Analytics - Dashboard Completo";case"peak-hours":return"Analytics - Horas Pico";case"top-customers":return"Analytics - Top Clientes";case"top-sellers":return"Analytics - Top Vendedoras";case"retention":return"Analytics - Retenci칩n de Clientes";case"trends":return"Analytics - Tendencias de Ventas";case"cross-selling":return"Analytics - Cross-Selling";default:return"Analytics Avanzado"}})());const n=[{id:"dashboard",label:"Dashboard Completo",icon:v,description:"Vista unificada de KPIs"},{id:"peak-hours",label:"Horas Pico",icon:o,description:"Mejores horas de venta"},{id:"top-customers",label:"Top Clientes",icon:x,description:"Clientes que m치s compran"},{id:"top-sellers",label:"Top Vendedoras",icon:m,description:"Vendedoras destacadas"},{id:"retention",label:"Retenci칩n",icon:h,description:"An치lisis RFM"},{id:"trends",label:"Tendencias",icon:p,description:"Patrones de venta"},{id:"cross-selling",label:"Cross-Selling",icon:g,description:"Productos relacionados"}];return a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50",children:[a.jsx("div",{className:"bg-white shadow-md border-b border-gray-200",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("button",{onClick:()=>{e("/dashboard")},className:"p-2 hover:bg-gray-100 rounded-lg transition-all",title:"Volver al Dashboard",children:a.jsx(y,{className:"w-6 h-6 text-gray-600"})}),a.jsxs("div",{children:[a.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(N,{className:"w-7 h-7 text-blue-600"}),"Analytics Avanzado"]}),a.jsx("p",{className:"text-sm text-gray-600",children:"An치lisis inteligente de ventas"})]})]})})})}),a.jsx("div",{className:"bg-white shadow-sm border-b border-gray-200",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4",children:a.jsx("div",{className:"flex gap-2 overflow-x-auto py-2",children:n.map(e=>{const t=e.icon,r=s===e.id;return a.jsxs("button",{onClick:()=>d(e.id),className:"flex items-center gap-2 px-4 py-2 rounded-lg whitespace-nowrap transition-all "+(r?"bg-blue-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[a.jsx(t,{className:"w-4 h-4 "+(r?"text-white":"text-gray-600")}),a.jsxs("div",{className:"text-left",children:[a.jsx("div",{className:"text-sm font-semibold "+(r?"text-white":"text-gray-900"),children:e.label}),a.jsx("div",{className:"text-xs "+(r?"text-blue-100":"text-gray-500"),children:e.description})]})]},e.id)})})})}),a.jsx("div",{className:"max-w-7xl mx-auto px-4 py-6",children:(()=>{switch(s){case"dashboard":default:return a.jsx(_,{});case"peak-hours":return a.jsx(w,{});case"top-customers":return a.jsx(C,{});case"top-sellers":return a.jsx(k,{});case"retention":return a.jsx(S,{});case"trends":return a.jsx(E,{});case"cross-selling":return a.jsx(T,{})}})()})]})};export{P as default};
