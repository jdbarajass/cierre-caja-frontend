import{l as e,b as s,j as t,a}from"./index-C7COjiXz.js";import{r,u as l}from"./react-vendor-BQCAaWH2.js";import{A as n,R as i,P as d,t as o,D as c,T as x,G as m,n as h,o as p,v as g,w as b,I as j,l as u,x as N,p as y,j as f,u as v}from"./icons-ftboP15Z.js";const w=async()=>{const t="/api/inventory/summary";try{e.info("Obteniendo resumen de inventario:",t);const a=await s(t);if(!a.ok){const e=await a.json().catch(()=>({}));throw new Error(e.error||"Error al obtener resumen de inventario")}const r=await a.json();return e.info("Resumen de inventario obtenido exitosamente"),r}catch(a){throw e.error("Error al obtener resumen de inventario:",a.message),a}},_=async()=>{const t="/api/inventory/by-category";try{e.info("Obteniendo an치lisis por categor칤a:",t);const a=await s(t);if(!a.ok){const e=await a.json().catch(()=>({}));throw new Error(e.error||"Error al obtener an치lisis por categor칤a")}const r=await a.json();return e.info("An치lisis por categor칤a obtenido exitosamente"),r}catch(a){throw e.error("Error al obtener an치lisis por categor칤a:",a.message),a}},C=async()=>{const t="/api/inventory/by-size";try{e.info("Obteniendo an치lisis por talla:",t);const a=await s(t);if(!a.ok){const e=await a.json().catch(()=>({}));throw new Error(e.error||"Error al obtener an치lisis por talla")}const r=await a.json();return e.info("An치lisis por talla obtenido exitosamente"),r}catch(a){throw e.error("Error al obtener an치lisis por talla:",a.message),a}},k=async()=>{const t="/api/inventory/out-of-stock";try{e.info("Obteniendo productos sin stock:",t);const a=await s(t);if(!a.ok){const e=await a.json().catch(()=>({}));throw new Error(e.error||"Error al obtener productos sin stock")}const r=await a.json();return e.info("Productos sin stock obtenidos exitosamente"),r}catch(a){throw e.error("Error al obtener productos sin stock:",a.message),a}},$=async(t=5)=>{const a=`/api/inventory/low-stock?threshold=${t}`;try{e.info("Obteniendo productos con bajo stock:",a);const t=await s(a);if(!t.ok){const e=await t.json().catch(()=>({}));throw new Error(e.error||"Error al obtener productos con bajo stock")}const r=await t.json();return e.info("Productos con bajo stock obtenidos exitosamente"),r}catch(r){throw e.error("Error al obtener productos con bajo stock:",r.message),r}},E=()=>{const[e,s]=r.useState(null),[a,l]=r.useState(null),[m,h]=r.useState(null),[p,g]=r.useState(!0),[b,j]=r.useState(null),u=async()=>{g(!0),j(null);try{const[e,t,a]=await Promise.all([w(),k(),$(5)]);s(e.summary),l(t),h(a)}catch(e){j(e.message)}finally{g(!1)}};r.useEffect(()=>{u()},[]);const N=e=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),y=e=>e>=20?"text-green-600 bg-green-100":e>=10?"text-yellow-600 bg-yellow-100":"text-red-600 bg-red-100";return p?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"}),t.jsx("p",{className:"mt-4 text-gray-600 font-medium",children:"Cargando datos de inventario..."})]})}):b?t.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[t.jsxs("div",{className:"flex items-center gap-3 text-red-800",children:[t.jsx(n,{className:"w-6 h-6"}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold",children:"Error al cargar inventario"}),t.jsx("p",{className:"text-sm",children:b})]})]}),t.jsxs("button",{onClick:u,className:"mt-4 flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-all",children:[t.jsx(i,{className:"w-4 h-4"}),"Reintentar"]})]}):e?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Resumen Ejecutivo"}),t.jsxs("button",{onClick:u,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-all",children:[t.jsx(i,{className:"w-4 h-4"}),"Actualizar"]})]}),((null==a?void 0:a.total)>0||(null==m?void 0:m.total)>0)&&t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(null==a?void 0:a.total)>0&&t.jsx("div",{className:"bg-red-50 border-2 border-red-200 rounded-xl p-4",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"p-3 bg-red-100 rounded-lg",children:t.jsx(n,{className:"w-6 h-6 text-red-600"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-red-600 font-medium",children:"Sin Stock"}),t.jsxs("p",{className:"text-2xl font-bold text-red-700",children:[a.total," productos"]})]})]})}),(null==m?void 0:m.total)>0&&t.jsx("div",{className:"bg-yellow-50 border-2 border-yellow-200 rounded-xl p-4",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"p-3 bg-yellow-100 rounded-lg",children:t.jsx(n,{className:"w-6 h-6 text-yellow-600"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-yellow-600 font-medium",children:"Bajo Stock"}),t.jsxs("p",{className:"text-2xl font-bold text-yellow-700",children:[m.total," productos"]})]})]})})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[t.jsx("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-200 hover:shadow-lg transition-shadow",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"Total Items"}),t.jsx("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:e.total_items}),t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Con stock: ",e.total_items_con_stock]})]}),t.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:t.jsx(d,{className:"w-8 h-8 text-blue-600"})})]})}),t.jsx("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-200 hover:shadow-lg transition-shadow",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"Total Unidades"}),t.jsx("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:e.total_unidades}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"En inventario"})]}),t.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:t.jsx(o,{className:"w-8 h-8 text-purple-600"})})]})}),t.jsx("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-200 hover:shadow-lg transition-shadow",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"Valor Inventario"}),t.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:N(e.valor_total_inventario)}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Costo total"})]}),t.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:t.jsx(c,{className:"w-8 h-8 text-green-600"})})]})}),t.jsx("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-200 hover:shadow-lg transition-shadow",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"Margen Esperado"}),t.jsxs("p",{className:`text-3xl font-bold mt-2 ${y(e.porcentaje_margen).split(" ")[0]}`,children:[e.porcentaje_margen.toFixed(1),"%"]}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:N(e.margen_esperado)})]}),t.jsx("div",{className:`p-3 rounded-lg ${y(e.porcentaje_margen).split(" ")[1]}`,children:t.jsx(x,{className:`w-8 h-8 ${y(e.porcentaje_margen).split(" ")[0]}`})})]})})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-200",children:[t.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Valor de Inventario vs Potencial de Venta"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Valor Inventario (Costo)"}),t.jsx("p",{className:"text-2xl font-bold text-blue-600",children:N(e.valor_total_inventario)}),t.jsx("div",{className:"mt-2 h-2 bg-blue-200 rounded-full",children:t.jsx("div",{className:"h-2 bg-blue-600 rounded-full",style:{width:"100%"}})})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Valor Potencial Venta"}),t.jsx("p",{className:"text-2xl font-bold text-green-600",children:N(e.valor_potencial_venta)}),t.jsx("div",{className:"mt-2 h-2 bg-green-200 rounded-full",children:t.jsx("div",{className:"h-2 bg-green-600 rounded-full",style:{width:e.valor_potencial_venta/e.valor_total_inventario*100+"%"}})})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Ganancia Esperada"}),t.jsx("p",{className:"text-2xl font-bold text-purple-600",children:N(e.margen_esperado)}),t.jsx("div",{className:"mt-2 h-2 bg-purple-200 rounded-full",children:t.jsx("div",{className:"h-2 bg-purple-600 rounded-full",style:{width:`${e.porcentaje_margen}%`}})})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl shadow-md p-6 border border-blue-200",children:[t.jsx("h4",{className:"text-sm font-semibold text-blue-900 mb-2",children:"Costo Promedio por Unidad"}),t.jsx("p",{className:"text-3xl font-bold text-blue-700",children:N(e.costo_promedio_por_unidad)})]}),t.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-xl shadow-md p-6 border border-green-200",children:[t.jsx("h4",{className:"text-sm font-semibold text-green-900 mb-2",children:"Precio Promedio de Venta"}),t.jsx("p",{className:"text-3xl font-bold text-green-700",children:N(e.precio_promedio_venta)})]})]})]}):t.jsx("div",{className:"text-center py-12 text-gray-500",children:"No hay datos de inventario disponibles"})},S=()=>{const[a,l]=r.useState(null),[o,c]=r.useState(!0),[x,g]=r.useState(null),[b,j]=r.useState(null),u=async()=>{c(!0),g(null);try{const t=await(async()=>{const t="/api/inventory/by-department";try{e.info("Obteniendo an치lisis por departamento:",t);const a=await s(t);if(!a.ok){const e=await a.json().catch(()=>({}));throw new Error(e.error||"Error al obtener an치lisis por departamento")}const r=await a.json();return e.info("An치lisis por departamento obtenido exitosamente"),r}catch(x){throw e.error("Error al obtener an치lisis por departamento:",x.message),x}})();l(t.data)}catch(t){g(t.message)}finally{c(!1)}};r.useEffect(()=>{u()},[]);const N=e=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),y=e=>{const s={HOMBRE:{bg:"bg-blue-50",border:"border-blue-200",text:"text-blue-700",badge:"bg-blue-100 text-blue-800"},MUJER:{bg:"bg-pink-50",border:"border-pink-200",text:"text-pink-700",badge:"bg-pink-100 text-pink-800"},"NI칌O":{bg:"bg-green-50",border:"border-green-200",text:"text-green-700",badge:"bg-green-100 text-green-800"},"NI칌A":{bg:"bg-purple-50",border:"border-purple-200",text:"text-purple-700",badge:"bg-purple-100 text-purple-800"},UNKNOWN:{bg:"bg-gray-50",border:"border-gray-200",text:"text-gray-700",badge:"bg-gray-100 text-gray-800"}};return s[e]||s.UNKNOWN},f=e=>{const s=a?Object.values(a).reduce((e,s)=>e+(s.valor_inventario||0),0):0;return s>0?(e/s*100).toFixed(1):0};if(o)return t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}),t.jsx("p",{className:"mt-4 text-gray-600 font-medium",children:"Cargando an치lisis por departamento..."})]})});if(x)return t.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[t.jsxs("div",{className:"flex items-center gap-3 text-red-800",children:[t.jsx(n,{className:"w-6 h-6"}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold",children:"Error al cargar an치lisis"}),t.jsx("p",{className:"text-sm",children:x})]})]}),t.jsxs("button",{onClick:u,className:"mt-4 flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-all",children:[t.jsx(i,{className:"w-4 h-4"}),"Reintentar"]})]});if(!a||0===Object.keys(a).length)return t.jsx("div",{className:"text-center py-12 text-gray-500",children:"No hay datos de departamentos disponibles"});const v=Object.entries(a);return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"An치lisis por Departamento"}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Distribuci칩n de inventario por departamento"})]}),t.jsxs("button",{onClick:u,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-all",children:[t.jsx(i,{className:"w-4 h-4"}),"Actualizar"]})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-200",children:[t.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Distribuci칩n Total"}),t.jsx("div",{className:"space-y-3",children:v.map(([e,s])=>{const a=y(e),r=f(s.valor_inventario);return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsx("span",{className:`font-semibold ${a.text}`,children:e}),t.jsxs("span",{className:"text-sm text-gray-600",children:[r,"%"]})]}),t.jsx("div",{className:"w-full h-4 bg-gray-200 rounded-full overflow-hidden",children:t.jsx("div",{className:`h-full ${a.badge.split(" ")[0]} transition-all`,style:{width:`${r}%`}})}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:N(s.valor_inventario)})]},e)})})]}),t.jsx("div",{className:"grid grid-cols-1 gap-6",children:v.map(([e,s])=>{const a=y(e),r=b===e,l=s.por_categoria&&Object.keys(s.por_categoria).length>0;return t.jsxs("div",{className:`bg-white rounded-xl shadow-md border-2 ${a.border}`,children:[t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:`p-3 ${a.badge} rounded-lg`,children:t.jsx(m,{className:"w-6 h-6"})}),t.jsxs("div",{children:[t.jsx("h3",{className:`text-xl font-bold ${a.text}`,children:e}),t.jsxs("p",{className:"text-sm text-gray-600",children:[f(s.valor_inventario),"% del inventario total"]})]})]}),l&&t.jsx("button",{onClick:()=>j(r?null:e),className:`p-2 ${a.bg} rounded-lg hover:${a.badge} transition-colors`,children:r?t.jsx(h,{className:"w-5 h-5"}):t.jsx(p,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:`${a.bg} rounded-lg p-4`,children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Total Items"}),t.jsx("p",{className:`text-2xl font-bold ${a.text}`,children:s.total_items})]}),t.jsxs("div",{className:`${a.bg} rounded-lg p-4`,children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Total Unidades"}),t.jsx("p",{className:`text-2xl font-bold ${a.text}`,children:s.total_unidades})]}),t.jsxs("div",{className:`${a.bg} rounded-lg p-4`,children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Valor Inventario"}),t.jsx("p",{className:`text-lg font-bold ${a.text}`,children:N(s.valor_inventario)})]}),t.jsxs("div",{className:`${a.bg} rounded-lg p-4`,children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Margen"}),t.jsx("p",{className:`text-lg font-bold ${a.text}`,children:N(s.margen)})]})]}),t.jsx("div",{className:`mt-4 ${a.bg} rounded-lg p-4`,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Valor Potencial de Venta"}),t.jsx("p",{className:`text-xl font-bold ${a.text}`,children:N(s.valor_potencial_venta)})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Ganancia Esperada"}),t.jsxs("p",{className:"text-lg font-semibold text-green-600",children:[(s.margen/s.valor_inventario*100).toFixed(1),"%"]})]})]})})]}),r&&l&&t.jsxs("div",{className:`border-t-2 ${a.border} p-6 ${a.bg}`,children:[t.jsxs("h4",{className:"font-bold text-gray-900 mb-4 flex items-center gap-2",children:[t.jsx(d,{className:"w-5 h-5"}),"Desglose por Categor칤a"]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-white border-b-2 border-gray-200",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Categor칤a"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Items"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Unidades"}),t.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700",children:"Valor Inventario"}),t.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700",children:"% del Depto"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:Object.entries(s.por_categoria).sort(([,e],[,s])=>s.valor_inventario-e.valor_inventario).map(([e,r])=>{const l=(r.valor_inventario/s.valor_inventario*100).toFixed(1);return t.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[t.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:e}),t.jsx("td",{className:"px-4 py-3 text-sm text-center text-gray-600",children:r.total_items}),t.jsx("td",{className:"px-4 py-3 text-sm text-center text-gray-600",children:r.total_unidades}),t.jsx("td",{className:"px-4 py-3 text-sm font-semibold text-right text-gray-900",children:N(r.valor_inventario)}),t.jsx("td",{className:"px-4 py-3 text-sm text-right",children:t.jsxs("span",{className:`inline-flex px-2 py-1 rounded-full ${a.badge} font-semibold`,children:[l,"%"]})})]},e)})})]})})]})]},e)})})]})},A=()=>{const[e,s]=r.useState(null),[a,l]=r.useState(null),[d,o]=r.useState(!0),[c,x]=r.useState(null),[m,j]=r.useState(5),[u,N]=r.useState(""),[y,f]=r.useState(""),[v,w]=r.useState(!0),[_,C]=r.useState(!0),E=async()=>{o(!0),x(null);try{const[e,t]=await Promise.all([k(),$(m)]);s(e),l(t)}catch(e){x(e.message)}finally{o(!1)}};r.useEffect(()=>{E()},[m]);const S=e=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),A=e=>e?e.filter(e=>{const s=!u||e.departamento===u,t=!y||e.categoria===y;return s&&t}):[];if(d)return t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-yellow-600"}),t.jsx("p",{className:"mt-4 text-gray-600 font-medium",children:"Cargando alertas de stock..."})]})});if(c)return t.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[t.jsxs("div",{className:"flex items-center gap-3 text-red-800",children:[t.jsx(n,{className:"w-6 h-6"}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold",children:"Error al cargar alertas"}),t.jsx("p",{className:"text-sm",children:c})]})]}),t.jsxs("button",{onClick:E,className:"mt-4 flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-all",children:[t.jsx(i,{className:"w-4 h-4"}),"Reintentar"]})]});const I=A((null==e?void 0:e.products)||[]),P=A((null==a?void 0:a.products)||[]);return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Alertas de Stock"}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Productos sin stock y con inventario bajo"})]}),t.jsxs("button",{onClick:E,className:"flex items-center gap-2 px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition-all",children:[t.jsx(i,{className:"w-4 h-4"}),"Actualizar"]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsx("div",{className:"bg-red-50 border-2 border-red-200 rounded-xl p-6",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"p-3 bg-red-100 rounded-lg",children:t.jsx(n,{className:"w-8 h-8 text-red-600"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-red-600 font-medium",children:"Sin Stock"}),t.jsx("p",{className:"text-4xl font-bold text-red-700",children:(null==e?void 0:e.total)||0})]})]})}),t.jsx("div",{className:"bg-yellow-50 border-2 border-yellow-200 rounded-xl p-6",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"p-3 bg-yellow-100 rounded-lg",children:t.jsx(g,{className:"w-8 h-8 text-yellow-600"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-yellow-600 font-medium",children:"Bajo Stock"}),t.jsx("p",{className:"text-4xl font-bold text-yellow-700",children:(null==a?void 0:a.total)||0})]})]})}),t.jsx("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-xl p-6",children:t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-blue-600 font-medium mb-2",children:"Umbral de Stock Bajo"}),t.jsx("input",{type:"number",min:"1",max:"20",value:m,onChange:e=>j(parseInt(e.target.value)||5),className:"w-full px-4 py-2 text-2xl font-bold text-blue-700 bg-white border-2 border-blue-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),t.jsxs("p",{className:"text-xs text-gray-600 mt-2",children:["Productos con menos de ",m," unidades"]})]})})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-md p-4 border border-gray-200",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t.jsx(b,{className:"w-5 h-5 text-gray-600"}),t.jsx("h3",{className:"font-semibold text-gray-900",children:"Filtros"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Departamento"}),t.jsxs("select",{value:u,onChange:e=>N(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"",children:"Todos"}),(()=>{const s=new Set;return(null==e?void 0:e.products)&&e.products.forEach(e=>s.add(e.departamento)),(null==a?void 0:a.products)&&a.products.forEach(e=>s.add(e.departamento)),Array.from(s).sort()})().map(e=>t.jsx("option",{value:e,children:e},e))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Categor칤a"}),t.jsxs("select",{value:y,onChange:e=>f(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"",children:"Todas"}),(()=>{const s=new Set;return(null==e?void 0:e.products)&&e.products.forEach(e=>s.add(e.categoria)),(null==a?void 0:a.products)&&a.products.forEach(e=>s.add(e.categoria)),Array.from(s).sort()})().map(e=>t.jsx("option",{value:e,children:e},e))]})]}),t.jsx("div",{className:"flex items-end",children:t.jsx("button",{onClick:()=>{N(""),f("")},className:"w-full px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-all",children:"Limpiar Filtros"})})]})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-red-200",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 cursor-pointer hover:bg-red-50 transition-colors",onClick:()=>w(!v),children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(n,{className:"w-6 h-6 text-red-600"}),t.jsxs("h3",{className:"text-lg font-bold text-gray-900",children:["Productos Sin Stock (",I.length,")"]})]}),v?t.jsx(h,{className:"w-5 h-5 text-gray-600"}):t.jsx(p,{className:"w-5 h-5 text-gray-600"})]}),v&&t.jsx("div",{className:"border-t border-red-200 overflow-x-auto",children:I.length>0?t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-red-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"ID"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Producto"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Categor칤a"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Departamento"}),t.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700",children:"Precio Venta"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:I.map(e=>t.jsxs("tr",{className:"hover:bg-red-50 transition-colors",children:[t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:e.id}),t.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:e.nombre}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:e.categoria}),t.jsx("td",{className:"px-4 py-3",children:t.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:e.departamento})}),t.jsx("td",{className:"px-4 py-3 text-sm font-semibold text-right text-gray-900",children:S(e.precio_venta)})]},e.id))})]}):t.jsx("div",{className:"p-8 text-center text-gray-500",children:"No hay productos sin stock con los filtros seleccionados"})})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-yellow-200",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 cursor-pointer hover:bg-yellow-50 transition-colors",onClick:()=>C(!_),children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(g,{className:"w-6 h-6 text-yellow-600"}),t.jsxs("h3",{className:"text-lg font-bold text-gray-900",children:["Productos con Bajo Stock (",P.length,")"]})]}),_?t.jsx(h,{className:"w-5 h-5 text-gray-600"}):t.jsx(p,{className:"w-5 h-5 text-gray-600"})]}),_&&t.jsx("div",{className:"border-t border-yellow-200 overflow-x-auto",children:P.length>0?t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-yellow-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"ID"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Producto"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Categor칤a"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Departamento"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Stock"}),t.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700",children:"Precio Venta"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:P.map(e=>t.jsxs("tr",{className:"hover:bg-yellow-50 transition-colors",children:[t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:e.id}),t.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:e.nombre}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:e.categoria}),t.jsx("td",{className:"px-4 py-3",children:t.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:e.departamento})}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsx("span",{className:"inline-flex px-3 py-1 text-sm font-bold rounded-full bg-yellow-100 text-yellow-800",children:e.cantidad_disponible})}),t.jsx("td",{className:"px-4 py-3 text-sm font-semibold text-right text-gray-900",children:S(e.precio_venta)})]},e.id))})]}):t.jsx("div",{className:"p-8 text-center text-gray-500",children:"No hay productos con bajo stock con los filtros seleccionados"})})]})]})},I=()=>{const[a,l]=r.useState(null),[d,o]=r.useState(!0),[c,x]=r.useState(null),m=async()=>{o(!0),x(null);try{const t=await(async()=>{const t="/api/inventory/abc-analysis";try{e.info("Obteniendo an치lisis ABC:",t);const a=await s(t);if(!a.ok){const e=await a.json().catch(()=>({}));throw new Error(e.error||"Error al obtener an치lisis ABC")}const r=await a.json();return e.info("An치lisis ABC obtenido exitosamente"),r}catch(c){throw e.error("Error al obtener an치lisis ABC:",c.message),c}})();l(t.data)}catch(t){x(t.message)}finally{o(!1)}};r.useEffect(()=>{m()},[]);const h=e=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),p=e=>({clase_A:{bg:"bg-red-50",border:"border-red-300",text:"text-red-700",badge:"bg-red-100 text-red-800",primary:"bg-red-500",label:"Clase A - CR칈TICOS"},clase_B:{bg:"bg-yellow-50",border:"border-yellow-300",text:"text-yellow-700",badge:"bg-yellow-100 text-yellow-800",primary:"bg-yellow-500",label:"Clase B - IMPORTANTES"},clase_C:{bg:"bg-green-50",border:"border-green-300",text:"text-green-700",badge:"bg-green-100 text-green-800",primary:"bg-green-500",label:"Clase C - NORMALES"}}[e]);if(d)return t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-red-600"}),t.jsx("p",{className:"mt-4 text-gray-600 font-medium",children:"Cargando an치lisis ABC..."})]})});if(c)return t.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[t.jsxs("div",{className:"flex items-center gap-3 text-red-800",children:[t.jsx(n,{className:"w-6 h-6"}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold",children:"Error al cargar an치lisis"}),t.jsx("p",{className:"text-sm",children:c})]})]}),t.jsxs("button",{onClick:m,className:"mt-4 flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-all",children:[t.jsx(i,{className:"w-4 h-4"}),"Reintentar"]})]});if(!a)return t.jsx("div",{className:"text-center py-12 text-gray-500",children:"No hay datos de an치lisis ABC disponibles"});const g=["clase_A","clase_B","clase_C"];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"An치lisis ABC (Pareto)"}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Clasificaci칩n de productos seg칰n su valor"})]}),t.jsxs("button",{onClick:m,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-all",children:[t.jsx(i,{className:"w-4 h-4"}),"Actualizar"]})]}),t.jsx("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-xl p-6",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(j,{className:"w-6 h-6 text-blue-600 flex-shrink-0 mt-1"}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-blue-900 mb-2",children:"쯈u칠 es el An치lisis ABC?"}),t.jsx("p",{className:"text-sm text-blue-800 mb-3",children:"El an치lisis ABC clasifica los productos seg칰n su contribuci칩n al valor total del inventario, siguiendo el principio de Pareto (80/20):"}),t.jsxs("ul",{className:"space-y-2 text-sm text-blue-800",children:[t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"font-bold text-red-600",children:"Clase A (Cr칤ticos):"}),t.jsx("span",{children:"~20% de los productos representan ~80% del valor total. Requieren control estricto."})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"font-bold text-yellow-600",children:"Clase B (Importantes):"}),t.jsx("span",{children:"~30% de los productos representan ~15% del valor. Control moderado."})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"font-bold text-green-600",children:"Clase C (Normales):"}),t.jsx("span",{children:"~50% de los productos representan ~5% del valor. Control b치sico."})]})]})]})]})}),t.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-200",children:[t.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-6",children:"Distribuci칩n ABC"}),t.jsx("div",{className:"space-y-4",children:g.map(e=>{const s=a[e],r=p(e);return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:`font-bold ${r.text}`,children:r.label}),t.jsxs("div",{className:"text-right",children:[t.jsxs("span",{className:"font-semibold text-gray-900",children:[s.porcentaje_valor.toFixed(1),"% del valor"]}),t.jsxs("span",{className:"text-sm text-gray-600 ml-2",children:["(",s.porcentaje_items.toFixed(1),"% items)"]})]})]}),t.jsx("div",{className:"w-full h-8 bg-gray-200 rounded-full overflow-hidden",children:t.jsx("div",{className:`h-full ${r.primary} transition-all flex items-center justify-end pr-3`,style:{width:`${s.porcentaje_valor}%`},children:t.jsx("span",{className:"text-white text-sm font-bold",children:s.porcentaje_valor>10?`${s.porcentaje_valor.toFixed(1)}%`:""})})})]},e)})})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:g.map(e=>{const s=a[e],r=p(e);return t.jsxs("div",{className:`bg-white rounded-xl shadow-lg border-2 ${r.border} overflow-hidden`,children:[t.jsx("div",{className:`${r.bg} border-b-2 ${r.border} p-4`,children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:`p-3 ${r.badge} rounded-lg`,children:t.jsx(u,{className:"w-6 h-6"})}),t.jsx("div",{children:t.jsx("h3",{className:`text-lg font-bold ${r.text}`,children:r.label})})]})}),t.jsxs("div",{className:"p-6 space-y-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Cantidad de Items"}),t.jsxs("div",{className:"flex items-baseline gap-2",children:[t.jsx("p",{className:`text-3xl font-bold ${r.text}`,children:s.cantidad_items}),t.jsxs("span",{className:`text-sm font-semibold ${r.badge} px-2 py-1 rounded-full`,children:[s.porcentaje_items.toFixed(1),"%"]})]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Valor de Inventario"}),t.jsx("p",{className:`text-xl font-bold ${r.text}`,children:h(s.valor_inventario)})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Contribuci칩n al Valor Total"}),t.jsx("div",{className:"w-full h-3 bg-gray-200 rounded-full overflow-hidden",children:t.jsx("div",{className:`h-full ${r.primary}`,style:{width:`${s.porcentaje_valor}%`}})}),t.jsxs("p",{className:`text-2xl font-bold ${r.text} mt-2`,children:[s.porcentaje_valor.toFixed(1),"%"]})]}),t.jsxs("div",{className:`${r.bg} rounded-lg p-3 mt-4`,children:[t.jsx("p",{className:"text-xs font-semibold text-gray-700 mb-1",children:"RECOMENDACI칍N:"}),t.jsxs("p",{className:"text-xs text-gray-700",children:["clase_A"===e&&"Control estricto, monitoreo constante, reabastecimiento prioritario","clase_B"===e&&"Control moderado, revisiones peri칩dicas, planificaci칩n est치ndar","clase_C"===e&&"Control b치sico, pedidos por lotes, revisi칩n ocasional"]})]})]})]},e)})}),t.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 overflow-hidden",children:[t.jsx("div",{className:"p-6 border-b border-gray-200",children:t.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Tabla Comparativa"})}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-700",children:"Clase"}),t.jsx("th",{className:"px-6 py-4 text-center text-sm font-semibold text-gray-700",children:"Items"}),t.jsx("th",{className:"px-6 py-4 text-center text-sm font-semibold text-gray-700",children:"% Items"}),t.jsx("th",{className:"px-6 py-4 text-right text-sm font-semibold text-gray-700",children:"Valor Inventario"}),t.jsx("th",{className:"px-6 py-4 text-center text-sm font-semibold text-gray-700",children:"% Valor"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:g.map(e=>{const s=a[e],r=p(e);return t.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[t.jsx("td",{className:"px-6 py-4",children:t.jsx("span",{className:`inline-flex px-3 py-1 rounded-full ${r.badge} font-bold`,children:r.label})}),t.jsx("td",{className:"px-6 py-4 text-center text-gray-900 font-semibold",children:s.cantidad_items}),t.jsx("td",{className:"px-6 py-4 text-center",children:t.jsxs("span",{className:"text-gray-600 font-medium",children:[s.porcentaje_items.toFixed(1),"%"]})}),t.jsx("td",{className:"px-6 py-4 text-right text-gray-900 font-bold",children:h(s.valor_inventario)}),t.jsx("td",{className:"px-6 py-4 text-center",children:t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx("div",{className:"w-24 h-2 bg-gray-200 rounded-full overflow-hidden",children:t.jsx("div",{className:`h-full ${r.primary}`,style:{width:`${s.porcentaje_valor}%`}})}),t.jsxs("span",{className:`font-bold ${r.text}`,children:[s.porcentaje_valor.toFixed(1),"%"]})]})})]},e)})})]})})]})]})},P=()=>{const[a,l]=r.useState(null),[d,o]=r.useState(!0),[m,h]=r.useState(null),[p,g]=r.useState(20),b=async()=>{o(!0),h(null);try{const t=await(async(t=20)=>{const a=`/api/inventory/top-by-value?limit=${t}`;try{e.info("Obteniendo top productos por valor:",a);const t=await s(a);if(!t.ok){const e=await t.json().catch(()=>({}));throw new Error(e.error||"Error al obtener top productos")}const r=await t.json();return e.info("Top productos obtenidos exitosamente"),r}catch(m){throw e.error("Error al obtener top productos:",m.message),m}})(p);l(t)}catch(t){h(t.message)}finally{o(!1)}};r.useEffect(()=>{b()},[p]);const j=e=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),u=e=>1===e?{icon:"游볞",color:"bg-yellow-100 text-yellow-800 border-yellow-300"}:2===e?{icon:"游볟",color:"bg-gray-100 text-gray-800 border-gray-300"}:3===e?{icon:"游볠",color:"bg-orange-100 text-orange-800 border-orange-300"}:{icon:`#${e}`,color:"bg-blue-100 text-blue-800 border-blue-300"},y=(e,s)=>s&&0!==s?((s-e)/s*100).toFixed(1):0;if(d)return t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"}),t.jsx("p",{className:"mt-4 text-gray-600 font-medium",children:"Cargando top productos..."})]})});if(m)return t.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[t.jsxs("div",{className:"flex items-center gap-3 text-red-800",children:[t.jsx(n,{className:"w-6 h-6"}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold",children:"Error al cargar top productos"}),t.jsx("p",{className:"text-sm",children:m})]})]}),t.jsxs("button",{onClick:b,className:"mt-4 flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-all",children:[t.jsx(i,{className:"w-4 h-4"}),"Reintentar"]})]});if(!(null==a?void 0:a.products)||0===a.products.length)return t.jsx("div",{className:"text-center py-12 text-gray-500",children:"No hay datos de productos disponibles"});const f=(null==a?void 0:a.products)?a.products.reduce((e,s)=>e+s.valor_inventario,0):0;return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Top Productos por Valor"}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Productos con mayor valor en inventario"})]}),t.jsxs("button",{onClick:b,className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-all",children:[t.jsx(i,{className:"w-4 h-4"}),"Actualizar"]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-200",children:[t.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Cantidad de Productos"}),t.jsx("div",{className:"flex gap-2",children:[10,20,50].map(e=>t.jsxs("button",{onClick:()=>g(e),className:"flex-1 px-4 py-2 rounded-lg font-semibold transition-all "+(p===e?"bg-purple-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:["Top ",e]},e))})]}),t.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl shadow-md p-6 border border-blue-200",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"p-3 bg-blue-200 rounded-lg",children:t.jsx(N,{className:"w-6 h-6 text-blue-700"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-blue-700 font-medium",children:"Productos Mostrados"}),t.jsx("p",{className:"text-3xl font-bold text-blue-900",children:a.products.length})]})]})}),t.jsx("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-xl shadow-md p-6 border border-green-200",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"p-3 bg-green-200 rounded-lg",children:t.jsx(c,{className:"w-6 h-6 text-green-700"})}),t.jsxs("div",{children:[t.jsxs("p",{className:"text-sm text-green-700 font-medium",children:["Valor Total (Top ",p,")"]}),t.jsx("p",{className:"text-2xl font-bold text-green-900",children:j(f)})]})]})})]}),a.products.length>=3&&t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:a.products.slice(0,3).map((e,s)=>{const a=s+1,r=u(a);return y(e.costo_unitario,e.precio_venta),t.jsxs("div",{className:`bg-white rounded-xl shadow-lg border-2 ${r.color.split(" ").pop().replace("text-","border-")} overflow-hidden transform hover:scale-105 transition-transform`,children:[t.jsxs("div",{className:`${r.color} p-4 text-center border-b-2`,children:[t.jsx("div",{className:"text-4xl mb-2",children:r.icon}),t.jsxs("p",{className:"font-bold text-lg",children:["Posici칩n ",a]})]}),t.jsxs("div",{className:"p-6 space-y-3",children:[t.jsx("h4",{className:"font-bold text-gray-900 text-sm line-clamp-2 min-h-[40px]",children:e.nombre}),t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsx("span",{className:"text-gray-600",children:"Categor칤a:"}),t.jsx("span",{className:"font-semibold text-gray-900",children:e.categoria})]}),t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsx("span",{className:"text-gray-600",children:"Cantidad:"}),t.jsxs("span",{className:"font-bold text-blue-600",children:[e.cantidad," uds"]})]}),t.jsxs("div",{className:"border-t pt-3",children:[t.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Valor en Inventario"}),t.jsx("p",{className:"text-2xl font-bold text-purple-600",children:j(e.valor_inventario)})]})]})]},e.id)})}),t.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 overflow-hidden",children:[t.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-purple-50 to-blue-50",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(x,{className:"w-6 h-6 text-purple-600"}),t.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Ranking Completo"})]})}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50 border-b-2 border-gray-200",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700 w-20",children:"Rank"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Producto"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Categor칤a"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Depto"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Cantidad"}),t.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700",children:"Costo Unit."}),t.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700",children:"Precio Venta"}),t.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700",children:"Valor Inv."}),t.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700",children:"Valor Venta"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Margen"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"% Total"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:a.products.map((e,s)=>{const a=s+1,r=u(a),l=y(e.costo_unitario,e.precio_venta),n=(e.valor_inventario/f*100).toFixed(1);return t.jsxs("tr",{className:"hover:bg-purple-50 transition-colors",children:[t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsx("span",{className:`inline-flex items-center justify-center w-10 h-10 rounded-full border-2 ${r.color} font-bold text-sm`,children:a})}),t.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900 max-w-xs truncate",children:e.nombre}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:e.categoria}),t.jsx("td",{className:"px-4 py-3",children:t.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:e.departamento})}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsx("span",{className:"inline-flex px-3 py-1 text-sm font-bold rounded-full bg-gray-100 text-gray-800",children:e.cantidad})}),t.jsx("td",{className:"px-4 py-3 text-sm text-right text-gray-700",children:j(e.costo_unitario)}),t.jsx("td",{className:"px-4 py-3 text-sm font-semibold text-right text-gray-900",children:j(e.precio_venta)}),t.jsx("td",{className:"px-4 py-3 text-sm font-bold text-right text-purple-700",children:j(e.valor_inventario)}),t.jsx("td",{className:"px-4 py-3 text-sm font-bold text-right text-green-700",children:j(e.valor_potencial_venta)}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsxs("span",{className:"inline-flex px-2 py-1 text-xs font-bold rounded-full "+(l>=20?"bg-green-100 text-green-800":l>=10?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:[l,"%"]})}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsxs("div",{className:"flex flex-col items-center gap-1",children:[t.jsx("div",{className:"w-16 h-2 bg-gray-200 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-purple-500",style:{width:`${n}%`}})}),t.jsxs("span",{className:"text-xs font-semibold text-gray-600",children:[n,"%"]})]})})]},e.id)})})]})})]})]})},F=()=>{const[e,s]=r.useState(null),[a,l]=r.useState(null),[d,o]=r.useState(!0),[c,x]=r.useState(null),[g,b]=r.useState(!0),[j,u]=r.useState(!0),N=async()=>{o(!0),x(null);try{const[e,t]=await Promise.all([_(),C()]);s(e.categories),l(t.sizes)}catch(e){x(e.message)}finally{o(!1)}};r.useEffect(()=>{N()},[]);const f=e=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),v=e=>e?e.reduce((e,s)=>e+(s.valor_inventario||0),0):0;if(d)return t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"}),t.jsx("p",{className:"mt-4 text-gray-600 font-medium",children:"Cargando an치lisis de categor칤as y tallas..."})]})});if(c)return t.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[t.jsxs("div",{className:"flex items-center gap-3 text-red-800",children:[t.jsx(n,{className:"w-6 h-6"}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold",children:"Error al cargar an치lisis"}),t.jsx("p",{className:"text-sm",children:c})]})]}),t.jsxs("button",{onClick:N,className:"mt-4 flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-all",children:[t.jsx(i,{className:"w-4 h-4"}),"Reintentar"]})]});const w=v(e),k=v(a);return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Categor칤as y Tallas"}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"An치lisis detallado por categor칤a y talla"})]}),t.jsxs("button",{onClick:N,className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-all",children:[t.jsx(i,{className:"w-4 h-4"}),"Actualizar"]})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 overflow-hidden",children:[t.jsxs("div",{className:"flex items-center justify-between p-6 bg-gradient-to-r from-blue-50 to-indigo-50 border-b border-gray-200 cursor-pointer hover:from-blue-100 hover:to-indigo-100 transition-colors",onClick:()=>b(!g),children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:t.jsx(m,{className:"w-6 h-6 text-blue-600"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"An치lisis por Categor칤a"}),t.jsxs("p",{className:"text-sm text-gray-600",children:[(null==e?void 0:e.length)||0," categor칤as - Valor total: ",f(w)]})]})]}),g?t.jsx(h,{className:"w-5 h-5 text-gray-600"}):t.jsx(p,{className:"w-5 h-5 text-gray-600"})]}),g&&e&&t.jsxs("div",{className:"p-6",children:[t.jsx("div",{className:"mb-6 space-y-3",children:e.sort((e,s)=>s.valor_inventario-e.valor_inventario).slice(0,10).map((e,s)=>{const a=w>0?e.valor_inventario/w*100:0;return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"inline-flex items-center justify-center w-6 h-6 rounded-full bg-blue-100 text-blue-700 text-xs font-bold",children:s+1}),t.jsx("span",{className:"font-semibold text-gray-900",children:e.categoria})]}),t.jsxs("span",{className:"text-sm text-gray-600",children:[a.toFixed(1),"% - ",f(e.valor_inventario)]})]}),t.jsx("div",{className:"w-full h-8 bg-gray-200 rounded-lg overflow-hidden",children:t.jsxs("div",{className:"h-full bg-gradient-to-r from-blue-500 to-indigo-500 flex items-center justify-between px-3 transition-all",style:{width:`${Math.max(a,5)}%`},children:[t.jsxs("span",{className:"text-white text-xs font-semibold",children:[e.total_items," items"]}),t.jsxs("span",{className:"text-white text-xs font-semibold",children:[e.total_unidades," uds"]})]})})]},e.categoria)})}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50 border-y border-gray-200",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"#"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Categor칤a"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Items"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Unidades"}),t.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700",children:"Valor Inventario"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"% del Total"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:e.sort((e,s)=>s.valor_inventario-e.valor_inventario).map((e,s)=>{const a=w>0?e.valor_inventario/w*100:0;return t.jsxs("tr",{className:"hover:bg-blue-50 transition-colors",children:[t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:s+1}),t.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:e.categoria}),t.jsx("td",{className:"px-4 py-3 text-sm text-center text-gray-700",children:e.total_items}),t.jsx("td",{className:"px-4 py-3 text-sm text-center font-semibold text-blue-600",children:e.total_unidades}),t.jsx("td",{className:"px-4 py-3 text-sm font-bold text-right text-gray-900",children:f(e.valor_inventario)}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsxs("span",{className:"inline-flex px-3 py-1 text-xs font-bold rounded-full bg-blue-100 text-blue-800",children:[a.toFixed(1),"%"]})})]},e.categoria)})})]})})]})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 overflow-hidden",children:[t.jsxs("div",{className:"flex items-center justify-between p-6 bg-gradient-to-r from-purple-50 to-pink-50 border-b border-gray-200 cursor-pointer hover:from-purple-100 hover:to-pink-100 transition-colors",onClick:()=>u(!j),children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:t.jsx(y,{className:"w-6 h-6 text-purple-600"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"An치lisis por Talla"}),t.jsxs("p",{className:"text-sm text-gray-600",children:[(null==a?void 0:a.length)||0," tallas - Valor total: ",f(k)]})]})]}),j?t.jsx(h,{className:"w-5 h-5 text-gray-600"}):t.jsx(p,{className:"w-5 h-5 text-gray-600"})]}),j&&a&&t.jsxs("div",{className:"p-6",children:[t.jsx("div",{className:"mb-6 space-y-3",children:a.sort((e,s)=>s.total_unidades-e.total_unidades).slice(0,15).map((e,s)=>{const r=Math.max(...a.map(e=>e.total_unidades)),l=r>0?e.total_unidades/r*100:0;return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"inline-flex items-center justify-center w-16 h-8 rounded-lg bg-purple-100 text-purple-700 text-sm font-bold border-2 border-purple-300",children:e.talla}),t.jsxs("span",{className:"text-sm text-gray-600",children:[e.cantidad_items," items diferentes"]})]}),t.jsxs("span",{className:"text-sm font-semibold text-gray-900",children:[e.total_unidades," unidades"]})]}),t.jsx("div",{className:"w-full h-6 bg-gray-200 rounded-lg overflow-hidden",children:t.jsx("div",{className:"h-full bg-gradient-to-r from-purple-500 to-pink-500 flex items-center justify-end px-3 transition-all",style:{width:`${Math.max(l,5)}%`},children:t.jsx("span",{className:"text-white text-xs font-semibold",children:f(e.valor_inventario)})})})]},e.talla)})}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50 border-y border-gray-200",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Talla"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Items Diferentes"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Total Unidades"}),t.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700",children:"Valor Inventario"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"% del Total (Valor)"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:a.sort((e,s)=>s.valor_inventario-e.valor_inventario).map(e=>{const s=k>0?e.valor_inventario/k*100:0;return t.jsxs("tr",{className:"hover:bg-purple-50 transition-colors",children:[t.jsx("td",{className:"px-4 py-3",children:t.jsx("span",{className:"inline-flex items-center justify-center min-w-[60px] px-3 py-1 rounded-lg bg-purple-100 text-purple-800 text-sm font-bold border border-purple-300",children:e.talla})}),t.jsx("td",{className:"px-4 py-3 text-sm text-center text-gray-700",children:e.cantidad_items}),t.jsx("td",{className:"px-4 py-3 text-sm text-center font-bold text-purple-600",children:e.total_unidades}),t.jsx("td",{className:"px-4 py-3 text-sm font-bold text-right text-gray-900",children:f(e.valor_inventario)}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsxs("span",{className:"inline-flex px-3 py-1 text-xs font-bold rounded-full bg-purple-100 text-purple-800",children:[s.toFixed(1),"%"]})})]},e.talla)})})]})})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-100 rounded-xl shadow-md p-6 border border-blue-200",children:[t.jsx("h4",{className:"text-sm font-semibold text-blue-900 mb-4",children:"Resumen de Categor칤as"}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-sm text-gray-700",children:"Total Categor칤as:"}),t.jsx("span",{className:"text-lg font-bold text-blue-700",children:(null==e?void 0:e.length)||0})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-sm text-gray-700",children:"Valor Total:"}),t.jsx("span",{className:"text-lg font-bold text-blue-700",children:f(w)})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-sm text-gray-700",children:"Promedio por Categor칤a:"}),t.jsx("span",{className:"text-lg font-bold text-blue-700",children:f((null==e?void 0:e.length)?w/e.length:0)})]})]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-100 rounded-xl shadow-md p-6 border border-purple-200",children:[t.jsx("h4",{className:"text-sm font-semibold text-purple-900 mb-4",children:"Resumen de Tallas"}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-sm text-gray-700",children:"Total Tallas:"}),t.jsx("span",{className:"text-lg font-bold text-purple-700",children:(null==a?void 0:a.length)||0})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-sm text-gray-700",children:"Valor Total:"}),t.jsx("span",{className:"text-lg font-bold text-purple-700",children:f(k)})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-sm text-gray-700",children:"Promedio por Talla:"}),t.jsx("span",{className:"text-lg font-bold text-purple-700",children:f((null==a?void 0:a.length)?k/a.length:0)})]})]})]})]})]})},T=()=>{const e=l(),[s,n]=r.useState("dashboard");a((()=>{switch(s){case"dashboard":return"Inventario - Dashboard";case"departamentos":return"Inventario - Departamentos";case"alertas":return"Inventario - Alertas de Stock";case"abc":return"Inventario - An치lisis ABC";case"top-productos":return"Inventario - Top Productos";case"categorias-tallas":return"Inventario - Categor칤as y Tallas";default:return"Inventario"}})());const i=[{id:"dashboard",label:"Dashboard",icon:v,description:"Resumen ejecutivo"},{id:"departamentos",label:"Departamentos",icon:m,description:"Por departamento"},{id:"alertas",label:"Alertas de Stock",icon:g,description:"Stock bajo y sin stock"},{id:"abc",label:"An치lisis ABC",icon:u,description:"Clasificaci칩n Pareto"},{id:"top-productos",label:"Top Productos",icon:x,description:"Mayor valor"},{id:"categorias-tallas",label:"Categor칤as y Tallas",icon:y,description:"An치lisis detallado"}];return t.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-green-50 via-white to-blue-50",children:[t.jsx("div",{className:"bg-white shadow-md border-b border-gray-200",children:t.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("button",{onClick:()=>{e("/dashboard")},className:"p-2 hover:bg-gray-100 rounded-lg transition-all",title:"Volver al Dashboard",children:t.jsx(f,{className:"w-6 h-6 text-gray-600"})}),t.jsxs("div",{children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[t.jsx(d,{className:"w-7 h-7 text-green-600"}),"An치lisis de Inventario"]}),t.jsx("p",{className:"text-sm text-gray-600",children:"Gesti칩n y an치lisis de inventario desde Alegra"})]})]})})})}),t.jsx("div",{className:"bg-white shadow-sm border-b border-gray-200",children:t.jsx("div",{className:"max-w-7xl mx-auto px-4",children:t.jsx("div",{className:"flex gap-2 overflow-x-auto py-2",children:i.map(e=>{const a=e.icon,r=s===e.id;return t.jsxs("button",{onClick:()=>n(e.id),className:"flex items-center gap-2 px-4 py-2 rounded-lg whitespace-nowrap transition-all "+(r?"bg-green-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[t.jsx(a,{className:"w-4 h-4 "+(r?"text-white":"text-gray-600")}),t.jsxs("div",{className:"text-left",children:[t.jsx("div",{className:"text-sm font-semibold "+(r?"text-white":"text-gray-900"),children:e.label}),t.jsx("div",{className:"text-xs "+(r?"text-green-100":"text-gray-500"),children:e.description})]})]},e.id)})})})}),t.jsx("div",{className:"max-w-7xl mx-auto px-4 py-6",children:(()=>{switch(s){case"dashboard":default:return t.jsx(E,{});case"departamentos":return t.jsx(S,{});case"alertas":return t.jsx(A,{});case"abc":return t.jsx(I,{});case"top-productos":return t.jsx(P,{});case"categorias-tallas":return t.jsx(F,{})}})()})]})};export{T as default};
