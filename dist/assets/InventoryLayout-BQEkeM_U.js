import{l as e,c as s,j as t,a}from"./index-CtZXYhnh.js";import{r}from"./react-vendor-CfGu_lG-.js";import{P as l,y as n,A as i,R as d,w as o,D as c,T as x,G as m,n as h,C as g,m as p,z as b,I as j,q as u,J as N,s as y,K as v,F as f,M as w,N as _,x as C,l as k,O as A,Q as S}from"./icons-D9pArZQn.js";const I=async()=>{const t="/api/inventory/summary";try{e.info("Obteniendo resumen de inventario:",t);const a=await s(t);if(!a.ok){const e=await a.json().catch(()=>({}));throw new Error(e.error||"Error al obtener resumen de inventario")}const r=await a.json();return e.info("Resumen de inventario obtenido exitosamente"),r}catch(a){throw e.error("Error al obtener resumen de inventario:",a.message),a}},E=async()=>{const t="/api/inventory/by-category";try{e.info("Obteniendo an치lisis por categor칤a:",t);const a=await s(t);if(!a.ok){const e=await a.json().catch(()=>({}));throw new Error(e.error||"Error al obtener an치lisis por categor칤a")}const r=await a.json();return e.info("An치lisis por categor칤a obtenido exitosamente"),r}catch(a){throw e.error("Error al obtener an치lisis por categor칤a:",a.message),a}},$=async()=>{const t="/api/inventory/by-size";try{e.info("Obteniendo an치lisis por talla:",t);const a=await s(t);if(!a.ok){const e=await a.json().catch(()=>({}));throw new Error(e.error||"Error al obtener an치lisis por talla")}const r=await a.json();return e.info("An치lisis por talla obtenido exitosamente"),r}catch(a){throw e.error("Error al obtener an치lisis por talla:",a.message),a}},T=async()=>{const t="/api/inventory/out-of-stock";try{e.info("Obteniendo productos sin stock:",t);const a=await s(t);if(!a.ok){const e=await a.json().catch(()=>({}));throw new Error(e.error||"Error al obtener productos sin stock")}const r=await a.json();return e.info("Productos sin stock obtenidos exitosamente"),r}catch(a){throw e.error("Error al obtener productos sin stock:",a.message),a}},F=async(t=5)=>{const a=`/api/inventory/low-stock?threshold=${t}`;try{e.info("Obteniendo productos con bajo stock:",a);const t=await s(a);if(!t.ok){const e=await t.json().catch(()=>({}));throw new Error(e.error||"Error al obtener productos con bajo stock")}const r=await t.json();return e.info("Productos con bajo stock obtenidos exitosamente"),r}catch(r){throw e.error("Error al obtener productos con bajo stock:",r.message),r}},P=()=>{const[e,s]=r.useState(null),[a,m]=r.useState(null),[h,g]=r.useState(null),[p,b]=r.useState(!1),[j,u]=r.useState(null),N=async()=>{b(!0),u(null);try{const[e,t,a]=await Promise.all([I(),T(),F(5)]);s(e.summary),m(t),g(a)}catch(e){u(e.message)}finally{b(!1)}},y=e=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),v=e=>e>=20?"text-green-600 bg-green-100":e>=10?"text-yellow-600 bg-yellow-100":"text-red-600 bg-red-100";return e||p||j?p?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-teal-600"}),t.jsx("p",{className:"mt-4 text-gray-600 font-medium",children:"Consultando inventario desde Alegra..."})]})}):j?t.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[t.jsxs("div",{className:"flex items-center gap-3 text-red-800",children:[t.jsx(i,{className:"w-6 h-6"}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold",children:"Error al cargar inventario"}),t.jsx("p",{className:"text-sm",children:j})]})]}),t.jsxs("button",{onClick:N,className:"mt-4 flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-all",children:[t.jsx(d,{className:"w-4 h-4"}),"Reintentar"]})]}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Resumen Ejecutivo"}),t.jsxs("button",{onClick:N,className:"flex items-center gap-2 px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-all",children:[t.jsx(d,{className:"w-4 h-4"}),"Actualizar"]})]}),((null==a?void 0:a.total)>0||(null==h?void 0:h.total)>0)&&t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(null==a?void 0:a.total)>0&&t.jsx("div",{className:"bg-red-50 border-2 border-red-200 rounded-xl p-4",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"p-3 bg-red-100 rounded-lg",children:t.jsx(i,{className:"w-6 h-6 text-red-600"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-red-600 font-medium",children:"Sin Stock"}),t.jsxs("p",{className:"text-2xl font-bold text-red-700",children:[a.total," productos"]})]})]})}),(null==h?void 0:h.total)>0&&t.jsx("div",{className:"bg-yellow-50 border-2 border-yellow-200 rounded-xl p-4",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"p-3 bg-yellow-100 rounded-lg",children:t.jsx(i,{className:"w-6 h-6 text-yellow-600"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-yellow-600 font-medium",children:"Bajo Stock"}),t.jsxs("p",{className:"text-2xl font-bold text-yellow-700",children:[h.total," productos"]})]})]})})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[t.jsx("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-200 hover:shadow-lg transition-shadow",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"Total Items"}),t.jsx("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:e.total_items}),t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Con stock: ",e.total_items_con_stock]})]}),t.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:t.jsx(l,{className:"w-8 h-8 text-blue-600"})})]})}),t.jsx("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-200 hover:shadow-lg transition-shadow",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"Total Unidades"}),t.jsx("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:e.total_unidades}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"En inventario"})]}),t.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:t.jsx(o,{className:"w-8 h-8 text-purple-600"})})]})}),t.jsx("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-200 hover:shadow-lg transition-shadow",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"Valor Inventario"}),t.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:y(e.valor_total_inventario)}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Costo total"})]}),t.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:t.jsx(c,{className:"w-8 h-8 text-green-600"})})]})}),t.jsx("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-200 hover:shadow-lg transition-shadow",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"Margen Esperado"}),t.jsxs("p",{className:`text-3xl font-bold mt-2 ${v(e.porcentaje_margen).split(" ")[0]}`,children:[e.porcentaje_margen.toFixed(1),"%"]}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:y(e.margen_esperado)})]}),t.jsx("div",{className:`p-3 rounded-lg ${v(e.porcentaje_margen).split(" ")[1]}`,children:t.jsx(x,{className:`w-8 h-8 ${v(e.porcentaje_margen).split(" ")[0]}`})})]})})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-200",children:[t.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Valor de Inventario vs Potencial de Venta"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Valor Inventario (Costo)"}),t.jsx("p",{className:"text-2xl font-bold text-blue-600",children:y(e.valor_total_inventario)}),t.jsx("div",{className:"mt-2 h-2 bg-blue-200 rounded-full",children:t.jsx("div",{className:"h-2 bg-blue-600 rounded-full",style:{width:"100%"}})})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Valor Potencial Venta"}),t.jsx("p",{className:"text-2xl font-bold text-green-600",children:y(e.valor_potencial_venta)}),t.jsx("div",{className:"mt-2 h-2 bg-green-200 rounded-full",children:t.jsx("div",{className:"h-2 bg-green-600 rounded-full",style:{width:e.valor_potencial_venta/e.valor_total_inventario*100+"%"}})})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Ganancia Esperada"}),t.jsx("p",{className:"text-2xl font-bold text-purple-600",children:y(e.margen_esperado)}),t.jsx("div",{className:"mt-2 h-2 bg-purple-200 rounded-full",children:t.jsx("div",{className:"h-2 bg-purple-600 rounded-full",style:{width:`${e.porcentaje_margen}%`}})})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl shadow-md p-6 border border-blue-200",children:[t.jsx("h4",{className:"text-sm font-semibold text-blue-900 mb-2",children:"Costo Promedio por Unidad"}),t.jsx("p",{className:"text-3xl font-bold text-blue-700",children:y(e.costo_promedio_por_unidad)})]}),t.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-xl shadow-md p-6 border border-green-200",children:[t.jsx("h4",{className:"text-sm font-semibold text-green-900 mb-2",children:"Precio Promedio de Venta"}),t.jsx("p",{className:"text-3xl font-bold text-green-700",children:y(e.precio_promedio_venta)})]})]})]}):t.jsx("div",{className:"bg-gradient-to-br from-teal-50 to-blue-50 border-2 border-teal-200 rounded-xl p-12",children:t.jsxs("div",{className:"text-center max-w-2xl mx-auto",children:[t.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-teal-100 rounded-full mb-6",children:t.jsx(l,{className:"w-10 h-10 text-teal-600"})}),t.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-3",children:"An치lisis de Inventario desde Alegra"}),t.jsx("p",{className:"text-gray-600 mb-8",children:"Consulta el inventario actual desde Alegra para ver m칠tricas detalladas, alertas de stock y an치lisis completo."}),t.jsxs("button",{onClick:N,className:"inline-flex items-center gap-3 px-8 py-4 bg-teal-600 text-white rounded-xl hover:bg-teal-700 transition-all shadow-lg hover:shadow-xl text-lg font-semibold",children:[t.jsx(n,{className:"w-6 h-6"}),"Consultar Inventario desde Alegra"]})]})})},D=()=>{const[a,o]=r.useState(null),[c,x]=r.useState(!1),[p,b]=r.useState(null),[j,u]=r.useState(null),N=async()=>{x(!0),b(null);try{const t=await(async()=>{const t="/api/inventory/by-department";try{e.info("Obteniendo an치lisis por departamento:",t);const a=await s(t);if(!a.ok){const e=await a.json().catch(()=>({}));throw new Error(e.error||"Error al obtener an치lisis por departamento")}const r=await a.json();return e.info("An치lisis por departamento obtenido exitosamente"),r}catch(p){throw e.error("Error al obtener an치lisis por departamento:",p.message),p}})();o(t.data)}catch(t){b(t.message)}finally{x(!1)}},y=e=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),v=e=>{const s={HOMBRE:{bg:"bg-blue-50",border:"border-blue-200",text:"text-blue-700",badge:"bg-blue-100 text-blue-800"},MUJER:{bg:"bg-pink-50",border:"border-pink-200",text:"text-pink-700",badge:"bg-pink-100 text-pink-800"},"NI칌O":{bg:"bg-green-50",border:"border-green-200",text:"text-green-700",badge:"bg-green-100 text-green-800"},"NI칌A":{bg:"bg-purple-50",border:"border-purple-200",text:"text-purple-700",badge:"bg-purple-100 text-purple-800"},UNKNOWN:{bg:"bg-gray-50",border:"border-gray-200",text:"text-gray-700",badge:"bg-gray-100 text-gray-800"}};return s[e]||s.UNKNOWN},f=e=>{const s=a?Object.values(a).reduce((e,s)=>e+(s.valor_inventario||0),0):0;return s>0?(e/s*100).toFixed(1):0};if(!a&&!c&&!p)return t.jsx("div",{className:"bg-gradient-to-br from-teal-50 to-blue-50 border-2 border-teal-200 rounded-xl p-12",children:t.jsxs("div",{className:"text-center max-w-2xl mx-auto",children:[t.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-teal-100 rounded-full mb-6",children:t.jsx(m,{className:"w-10 h-10 text-teal-600"})}),t.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-3",children:"An치lisis por Departamento"}),t.jsx("p",{className:"text-gray-600 mb-8",children:"Consulta el an치lisis detallado de inventario agrupado por departamentos desde Alegra."}),t.jsxs("button",{onClick:N,className:"inline-flex items-center gap-3 px-8 py-4 bg-teal-600 text-white rounded-xl hover:bg-teal-700 transition-all shadow-lg hover:shadow-xl text-lg font-semibold",children:[t.jsx(n,{className:"w-6 h-6"}),"Consultar An치lisis por Departamento"]})]})});if(c)return t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-teal-600"}),t.jsx("p",{className:"mt-4 text-gray-600 font-medium",children:"Consultando an치lisis por departamento..."})]})});if(p)return t.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[t.jsxs("div",{className:"flex items-center gap-3 text-red-800",children:[t.jsx(i,{className:"w-6 h-6"}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold",children:"Error al cargar an치lisis"}),t.jsx("p",{className:"text-sm",children:p})]})]}),t.jsxs("button",{onClick:N,className:"mt-4 flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-all",children:[t.jsx(d,{className:"w-4 h-4"}),"Reintentar"]})]});if(!a||0===Object.keys(a).length)return t.jsx("div",{className:"text-center py-12 text-gray-500",children:"No hay datos de departamentos disponibles"});const w=Object.entries(a);return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"An치lisis por Departamento"}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Distribuci칩n de inventario por departamento"})]}),t.jsxs("button",{onClick:N,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-all",children:[t.jsx(d,{className:"w-4 h-4"}),"Actualizar"]})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-200",children:[t.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Distribuci칩n Total"}),t.jsx("div",{className:"space-y-3",children:w.map(([e,s])=>{const a=v(e),r=f(s.valor_inventario);return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsx("span",{className:`font-semibold ${a.text}`,children:e}),t.jsxs("span",{className:"text-sm text-gray-600",children:[r,"%"]})]}),t.jsx("div",{className:"w-full h-4 bg-gray-200 rounded-full overflow-hidden",children:t.jsx("div",{className:`h-full ${a.badge.split(" ")[0]} transition-all`,style:{width:`${r}%`}})}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:y(s.valor_inventario)})]},e)})})]}),t.jsx("div",{className:"grid grid-cols-1 gap-6",children:w.map(([e,s])=>{const a=v(e),r=j===e,n=s.por_categoria&&Object.keys(s.por_categoria).length>0;return t.jsxs("div",{className:`bg-white rounded-xl shadow-md border-2 ${a.border}`,children:[t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:`p-3 ${a.badge} rounded-lg`,children:t.jsx(m,{className:"w-6 h-6"})}),t.jsxs("div",{children:[t.jsx("h3",{className:`text-xl font-bold ${a.text}`,children:e}),t.jsxs("p",{className:"text-sm text-gray-600",children:[f(s.valor_inventario),"% del inventario total"]})]})]}),n&&t.jsx("button",{onClick:()=>u(r?null:e),className:`p-2 ${a.bg} rounded-lg hover:${a.badge} transition-colors`,children:r?t.jsx(h,{className:"w-5 h-5"}):t.jsx(g,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:`${a.bg} rounded-lg p-4`,children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Total Items"}),t.jsx("p",{className:`text-2xl font-bold ${a.text}`,children:s.total_items})]}),t.jsxs("div",{className:`${a.bg} rounded-lg p-4`,children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Total Unidades"}),t.jsx("p",{className:`text-2xl font-bold ${a.text}`,children:s.total_unidades})]}),t.jsxs("div",{className:`${a.bg} rounded-lg p-4`,children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Valor Inventario"}),t.jsx("p",{className:`text-lg font-bold ${a.text}`,children:y(s.valor_inventario)})]}),t.jsxs("div",{className:`${a.bg} rounded-lg p-4`,children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Margen"}),t.jsx("p",{className:`text-lg font-bold ${a.text}`,children:y(s.margen)})]})]}),t.jsx("div",{className:`mt-4 ${a.bg} rounded-lg p-4`,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Valor Potencial de Venta"}),t.jsx("p",{className:`text-xl font-bold ${a.text}`,children:y(s.valor_potencial_venta)})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Ganancia Esperada"}),t.jsxs("p",{className:"text-lg font-semibold text-green-600",children:[(s.margen/s.valor_inventario*100).toFixed(1),"%"]})]})]})})]}),r&&n&&t.jsxs("div",{className:`border-t-2 ${a.border} p-6 ${a.bg}`,children:[t.jsxs("h4",{className:"font-bold text-gray-900 mb-4 flex items-center gap-2",children:[t.jsx(l,{className:"w-5 h-5"}),"Desglose por Categor칤a"]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-white border-b-2 border-gray-200",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Categor칤a"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Items"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Unidades"}),t.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700",children:"Valor Inventario"}),t.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700",children:"% del Depto"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:Object.entries(s.por_categoria).sort(([,e],[,s])=>s.valor_inventario-e.valor_inventario).map(([e,r])=>{const l=(r.valor_inventario/s.valor_inventario*100).toFixed(1);return t.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[t.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:e}),t.jsx("td",{className:"px-4 py-3 text-sm text-center text-gray-600",children:r.total_items}),t.jsx("td",{className:"px-4 py-3 text-sm text-center text-gray-600",children:r.total_unidades}),t.jsx("td",{className:"px-4 py-3 text-sm font-semibold text-right text-gray-900",children:y(r.valor_inventario)}),t.jsx("td",{className:"px-4 py-3 text-sm text-right",children:t.jsxs("span",{className:`inline-flex px-2 py-1 rounded-full ${a.badge} font-semibold`,children:[l,"%"]})})]},e)})})]})})]})]},e)})})]})},V=()=>{const[e,s]=r.useState(null),[a,l]=r.useState(null),[n,o]=r.useState(!0),[c,x]=r.useState(null),[m,j]=r.useState(5),[u,N]=r.useState(""),[y,v]=r.useState(""),[f,w]=r.useState(!0),[_,C]=r.useState(!0),k=async()=>{o(!0),x(null);try{const[e,t]=await Promise.all([T(),F(m)]);s(e),l(t)}catch(e){x(e.message)}finally{o(!1)}};r.useEffect(()=>{k()},[m]);const A=e=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),S=e=>e?e.filter(e=>{const s=!u||e.departamento===u,t=!y||e.categoria===y;return s&&t}):[];if(n)return t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-yellow-600"}),t.jsx("p",{className:"mt-4 text-gray-600 font-medium",children:"Cargando alertas de stock..."})]})});if(c)return t.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[t.jsxs("div",{className:"flex items-center gap-3 text-red-800",children:[t.jsx(i,{className:"w-6 h-6"}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold",children:"Error al cargar alertas"}),t.jsx("p",{className:"text-sm",children:c})]})]}),t.jsxs("button",{onClick:k,className:"mt-4 flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-all",children:[t.jsx(d,{className:"w-4 h-4"}),"Reintentar"]})]});const I=S((null==e?void 0:e.products)||[]),E=S((null==a?void 0:a.products)||[]);return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Alertas de Stock"}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Productos sin stock y con inventario bajo"})]}),t.jsxs("button",{onClick:k,className:"flex items-center gap-2 px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition-all",children:[t.jsx(d,{className:"w-4 h-4"}),"Actualizar"]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsx("div",{className:"bg-red-50 border-2 border-red-200 rounded-xl p-6",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"p-3 bg-red-100 rounded-lg",children:t.jsx(i,{className:"w-8 h-8 text-red-600"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-red-600 font-medium",children:"Sin Stock"}),t.jsx("p",{className:"text-4xl font-bold text-red-700",children:(null==e?void 0:e.total)||0})]})]})}),t.jsx("div",{className:"bg-yellow-50 border-2 border-yellow-200 rounded-xl p-6",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"p-3 bg-yellow-100 rounded-lg",children:t.jsx(p,{className:"w-8 h-8 text-yellow-600"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-yellow-600 font-medium",children:"Bajo Stock"}),t.jsx("p",{className:"text-4xl font-bold text-yellow-700",children:(null==a?void 0:a.total)||0})]})]})}),t.jsx("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-xl p-6",children:t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-blue-600 font-medium mb-2",children:"Umbral de Stock Bajo"}),t.jsx("input",{type:"number",min:"1",max:"20",value:m,onChange:e=>j(parseInt(e.target.value)||5),className:"w-full px-4 py-2 text-2xl font-bold text-blue-700 bg-white border-2 border-blue-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),t.jsxs("p",{className:"text-xs text-gray-600 mt-2",children:["Productos con menos de ",m," unidades"]})]})})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-md p-4 border border-gray-200",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t.jsx(b,{className:"w-5 h-5 text-gray-600"}),t.jsx("h3",{className:"font-semibold text-gray-900",children:"Filtros"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Departamento"}),t.jsxs("select",{value:u,onChange:e=>N(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"",children:"Todos"}),(()=>{const s=new Set;return(null==e?void 0:e.products)&&e.products.forEach(e=>s.add(e.departamento)),(null==a?void 0:a.products)&&a.products.forEach(e=>s.add(e.departamento)),Array.from(s).sort()})().map(e=>t.jsx("option",{value:e,children:e},e))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Categor칤a"}),t.jsxs("select",{value:y,onChange:e=>v(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"",children:"Todas"}),(()=>{const s=new Set;return(null==e?void 0:e.products)&&e.products.forEach(e=>s.add(e.categoria)),(null==a?void 0:a.products)&&a.products.forEach(e=>s.add(e.categoria)),Array.from(s).sort()})().map(e=>t.jsx("option",{value:e,children:e},e))]})]}),t.jsx("div",{className:"flex items-end",children:t.jsx("button",{onClick:()=>{N(""),v("")},className:"w-full px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-all",children:"Limpiar Filtros"})})]})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-red-200",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 cursor-pointer hover:bg-red-50 transition-colors",onClick:()=>w(!f),children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(i,{className:"w-6 h-6 text-red-600"}),t.jsxs("h3",{className:"text-lg font-bold text-gray-900",children:["Productos Sin Stock (",I.length,")"]})]}),f?t.jsx(h,{className:"w-5 h-5 text-gray-600"}):t.jsx(g,{className:"w-5 h-5 text-gray-600"})]}),f&&t.jsx("div",{className:"border-t border-red-200 overflow-x-auto",children:I.length>0?t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-red-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"ID"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Producto"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Categor칤a"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Departamento"}),t.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700",children:"Precio Venta"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:I.map(e=>t.jsxs("tr",{className:"hover:bg-red-50 transition-colors",children:[t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:e.id}),t.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:e.nombre}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:e.categoria}),t.jsx("td",{className:"px-4 py-3",children:t.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:e.departamento})}),t.jsx("td",{className:"px-4 py-3 text-sm font-semibold text-right text-gray-900",children:A(e.precio_venta)})]},e.id))})]}):t.jsx("div",{className:"p-8 text-center text-gray-500",children:"No hay productos sin stock con los filtros seleccionados"})})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-yellow-200",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 cursor-pointer hover:bg-yellow-50 transition-colors",onClick:()=>C(!_),children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(p,{className:"w-6 h-6 text-yellow-600"}),t.jsxs("h3",{className:"text-lg font-bold text-gray-900",children:["Productos con Bajo Stock (",E.length,")"]})]}),_?t.jsx(h,{className:"w-5 h-5 text-gray-600"}):t.jsx(g,{className:"w-5 h-5 text-gray-600"})]}),_&&t.jsx("div",{className:"border-t border-yellow-200 overflow-x-auto",children:E.length>0?t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-yellow-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"ID"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Producto"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Categor칤a"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Departamento"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Stock"}),t.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700",children:"Precio Venta"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:E.map(e=>t.jsxs("tr",{className:"hover:bg-yellow-50 transition-colors",children:[t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:e.id}),t.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:e.nombre}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:e.categoria}),t.jsx("td",{className:"px-4 py-3",children:t.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:e.departamento})}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsx("span",{className:"inline-flex px-3 py-1 text-sm font-bold rounded-full bg-yellow-100 text-yellow-800",children:e.cantidad_disponible})}),t.jsx("td",{className:"px-4 py-3 text-sm font-semibold text-right text-gray-900",children:A(e.precio_venta)})]},e.id))})]}):t.jsx("div",{className:"p-8 text-center text-gray-500",children:"No hay productos con bajo stock con los filtros seleccionados"})})]})]})},O=()=>{const[a,l]=r.useState(null),[n,o]=r.useState(!0),[c,x]=r.useState(null),m=async()=>{o(!0),x(null);try{const t=await(async()=>{const t="/api/inventory/abc-analysis";try{e.info("Obteniendo an치lisis ABC:",t);const a=await s(t);if(!a.ok){const e=await a.json().catch(()=>({}));throw new Error(e.error||"Error al obtener an치lisis ABC")}const r=await a.json();return e.info("An치lisis ABC obtenido exitosamente"),r}catch(c){throw e.error("Error al obtener an치lisis ABC:",c.message),c}})();l(t.data)}catch(t){x(t.message)}finally{o(!1)}};r.useEffect(()=>{m()},[]);const h=e=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),g=e=>({clase_A:{bg:"bg-red-50",border:"border-red-300",text:"text-red-700",badge:"bg-red-100 text-red-800",primary:"bg-red-500",label:"Clase A - CR칈TICOS"},clase_B:{bg:"bg-yellow-50",border:"border-yellow-300",text:"text-yellow-700",badge:"bg-yellow-100 text-yellow-800",primary:"bg-yellow-500",label:"Clase B - IMPORTANTES"},clase_C:{bg:"bg-green-50",border:"border-green-300",text:"text-green-700",badge:"bg-green-100 text-green-800",primary:"bg-green-500",label:"Clase C - NORMALES"}}[e]);if(n)return t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-red-600"}),t.jsx("p",{className:"mt-4 text-gray-600 font-medium",children:"Cargando an치lisis ABC..."})]})});if(c)return t.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[t.jsxs("div",{className:"flex items-center gap-3 text-red-800",children:[t.jsx(i,{className:"w-6 h-6"}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold",children:"Error al cargar an치lisis"}),t.jsx("p",{className:"text-sm",children:c})]})]}),t.jsxs("button",{onClick:m,className:"mt-4 flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-all",children:[t.jsx(d,{className:"w-4 h-4"}),"Reintentar"]})]});if(!a)return t.jsx("div",{className:"text-center py-12 text-gray-500",children:"No hay datos de an치lisis ABC disponibles"});const p=["clase_A","clase_B","clase_C"];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"An치lisis ABC (Pareto)"}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Clasificaci칩n de productos seg칰n su valor"})]}),t.jsxs("button",{onClick:m,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-all",children:[t.jsx(d,{className:"w-4 h-4"}),"Actualizar"]})]}),t.jsx("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-xl p-6",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(j,{className:"w-6 h-6 text-blue-600 flex-shrink-0 mt-1"}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-blue-900 mb-2",children:"쯈u칠 es el An치lisis ABC?"}),t.jsx("p",{className:"text-sm text-blue-800 mb-3",children:"El an치lisis ABC clasifica los productos seg칰n su contribuci칩n al valor total del inventario, siguiendo el principio de Pareto (80/20):"}),t.jsxs("ul",{className:"space-y-2 text-sm text-blue-800",children:[t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"font-bold text-red-600",children:"Clase A (Cr칤ticos):"}),t.jsx("span",{children:"~20% de los productos representan ~80% del valor total. Requieren control estricto."})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"font-bold text-yellow-600",children:"Clase B (Importantes):"}),t.jsx("span",{children:"~30% de los productos representan ~15% del valor. Control moderado."})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"font-bold text-green-600",children:"Clase C (Normales):"}),t.jsx("span",{children:"~50% de los productos representan ~5% del valor. Control b치sico."})]})]})]})]})}),t.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-200",children:[t.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-6",children:"Distribuci칩n ABC"}),t.jsx("div",{className:"space-y-4",children:p.map(e=>{const s=a[e],r=g(e);return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:`font-bold ${r.text}`,children:r.label}),t.jsxs("div",{className:"text-right",children:[t.jsxs("span",{className:"font-semibold text-gray-900",children:[s.porcentaje_valor.toFixed(1),"% del valor"]}),t.jsxs("span",{className:"text-sm text-gray-600 ml-2",children:["(",s.porcentaje_items.toFixed(1),"% items)"]})]})]}),t.jsx("div",{className:"w-full h-8 bg-gray-200 rounded-full overflow-hidden",children:t.jsx("div",{className:`h-full ${r.primary} transition-all flex items-center justify-end pr-3`,style:{width:`${s.porcentaje_valor}%`},children:t.jsx("span",{className:"text-white text-sm font-bold",children:s.porcentaje_valor>10?`${s.porcentaje_valor.toFixed(1)}%`:""})})})]},e)})})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:p.map(e=>{const s=a[e],r=g(e);return t.jsxs("div",{className:`bg-white rounded-xl shadow-lg border-2 ${r.border} overflow-hidden`,children:[t.jsx("div",{className:`${r.bg} border-b-2 ${r.border} p-4`,children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:`p-3 ${r.badge} rounded-lg`,children:t.jsx(u,{className:"w-6 h-6"})}),t.jsx("div",{children:t.jsx("h3",{className:`text-lg font-bold ${r.text}`,children:r.label})})]})}),t.jsxs("div",{className:"p-6 space-y-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Cantidad de Items"}),t.jsxs("div",{className:"flex items-baseline gap-2",children:[t.jsx("p",{className:`text-3xl font-bold ${r.text}`,children:s.cantidad_items}),t.jsxs("span",{className:`text-sm font-semibold ${r.badge} px-2 py-1 rounded-full`,children:[s.porcentaje_items.toFixed(1),"%"]})]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Valor de Inventario"}),t.jsx("p",{className:`text-xl font-bold ${r.text}`,children:h(s.valor_inventario)})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Contribuci칩n al Valor Total"}),t.jsx("div",{className:"w-full h-3 bg-gray-200 rounded-full overflow-hidden",children:t.jsx("div",{className:`h-full ${r.primary}`,style:{width:`${s.porcentaje_valor}%`}})}),t.jsxs("p",{className:`text-2xl font-bold ${r.text} mt-2`,children:[s.porcentaje_valor.toFixed(1),"%"]})]}),t.jsxs("div",{className:`${r.bg} rounded-lg p-3 mt-4`,children:[t.jsx("p",{className:"text-xs font-semibold text-gray-700 mb-1",children:"RECOMENDACI칍N:"}),t.jsxs("p",{className:"text-xs text-gray-700",children:["clase_A"===e&&"Control estricto, monitoreo constante, reabastecimiento prioritario","clase_B"===e&&"Control moderado, revisiones peri칩dicas, planificaci칩n est치ndar","clase_C"===e&&"Control b치sico, pedidos por lotes, revisi칩n ocasional"]})]})]})]},e)})}),t.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 overflow-hidden",children:[t.jsx("div",{className:"p-6 border-b border-gray-200",children:t.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Tabla Comparativa"})}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-700",children:"Clase"}),t.jsx("th",{className:"px-6 py-4 text-center text-sm font-semibold text-gray-700",children:"Items"}),t.jsx("th",{className:"px-6 py-4 text-center text-sm font-semibold text-gray-700",children:"% Items"}),t.jsx("th",{className:"px-6 py-4 text-right text-sm font-semibold text-gray-700",children:"Valor Inventario"}),t.jsx("th",{className:"px-6 py-4 text-center text-sm font-semibold text-gray-700",children:"% Valor"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:p.map(e=>{const s=a[e],r=g(e);return t.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[t.jsx("td",{className:"px-6 py-4",children:t.jsx("span",{className:`inline-flex px-3 py-1 rounded-full ${r.badge} font-bold`,children:r.label})}),t.jsx("td",{className:"px-6 py-4 text-center text-gray-900 font-semibold",children:s.cantidad_items}),t.jsx("td",{className:"px-6 py-4 text-center",children:t.jsxs("span",{className:"text-gray-600 font-medium",children:[s.porcentaje_items.toFixed(1),"%"]})}),t.jsx("td",{className:"px-6 py-4 text-right text-gray-900 font-bold",children:h(s.valor_inventario)}),t.jsx("td",{className:"px-6 py-4 text-center",children:t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx("div",{className:"w-24 h-2 bg-gray-200 rounded-full overflow-hidden",children:t.jsx("div",{className:`h-full ${r.primary}`,style:{width:`${s.porcentaje_valor}%`}})}),t.jsxs("span",{className:`font-bold ${r.text}`,children:[s.porcentaje_valor.toFixed(1),"%"]})]})})]},e)})})]})})]})]})},M=()=>{const[a,l]=r.useState(null),[n,o]=r.useState(!0),[m,h]=r.useState(null),[g,p]=r.useState(20),b=async()=>{o(!0),h(null);try{const t=await(async(t=20)=>{const a=`/api/inventory/top-by-value?limit=${t}`;try{e.info("Obteniendo top productos por valor:",a);const t=await s(a);if(!t.ok){const e=await t.json().catch(()=>({}));throw new Error(e.error||"Error al obtener top productos")}const r=await t.json();return e.info("Top productos obtenidos exitosamente"),r}catch(m){throw e.error("Error al obtener top productos:",m.message),m}})(g);l(t)}catch(t){h(t.message)}finally{o(!1)}};r.useEffect(()=>{b()},[g]);const j=e=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),u=e=>1===e?{icon:"游볞",color:"bg-yellow-100 text-yellow-800 border-yellow-300"}:2===e?{icon:"游볟",color:"bg-gray-100 text-gray-800 border-gray-300"}:3===e?{icon:"游볠",color:"bg-orange-100 text-orange-800 border-orange-300"}:{icon:`#${e}`,color:"bg-blue-100 text-blue-800 border-blue-300"},y=(e,s)=>s&&0!==s?((s-e)/s*100).toFixed(1):0;if(n)return t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"}),t.jsx("p",{className:"mt-4 text-gray-600 font-medium",children:"Cargando top productos..."})]})});if(m)return t.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[t.jsxs("div",{className:"flex items-center gap-3 text-red-800",children:[t.jsx(i,{className:"w-6 h-6"}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold",children:"Error al cargar top productos"}),t.jsx("p",{className:"text-sm",children:m})]})]}),t.jsxs("button",{onClick:b,className:"mt-4 flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-all",children:[t.jsx(d,{className:"w-4 h-4"}),"Reintentar"]})]});if(!(null==a?void 0:a.products)||0===a.products.length)return t.jsx("div",{className:"text-center py-12 text-gray-500",children:"No hay datos de productos disponibles"});const v=(null==a?void 0:a.products)?a.products.reduce((e,s)=>e+s.valor_inventario,0):0;return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Top Productos por Valor"}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Productos con mayor valor en inventario"})]}),t.jsxs("button",{onClick:b,className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-all",children:[t.jsx(d,{className:"w-4 h-4"}),"Actualizar"]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-200",children:[t.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Cantidad de Productos"}),t.jsx("div",{className:"flex gap-2",children:[10,20,50].map(e=>t.jsxs("button",{onClick:()=>p(e),className:"flex-1 px-4 py-2 rounded-lg font-semibold transition-all "+(g===e?"bg-purple-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:["Top ",e]},e))})]}),t.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl shadow-md p-6 border border-blue-200",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"p-3 bg-blue-200 rounded-lg",children:t.jsx(N,{className:"w-6 h-6 text-blue-700"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-blue-700 font-medium",children:"Productos Mostrados"}),t.jsx("p",{className:"text-3xl font-bold text-blue-900",children:a.products.length})]})]})}),t.jsx("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-xl shadow-md p-6 border border-green-200",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"p-3 bg-green-200 rounded-lg",children:t.jsx(c,{className:"w-6 h-6 text-green-700"})}),t.jsxs("div",{children:[t.jsxs("p",{className:"text-sm text-green-700 font-medium",children:["Valor Total (Top ",g,")"]}),t.jsx("p",{className:"text-2xl font-bold text-green-900",children:j(v)})]})]})})]}),a.products.length>=3&&t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:a.products.slice(0,3).map((e,s)=>{const a=s+1,r=u(a);return y(e.costo_unitario,e.precio_venta),t.jsxs("div",{className:`bg-white rounded-xl shadow-lg border-2 ${r.color.split(" ").pop().replace("text-","border-")} overflow-hidden transform hover:scale-105 transition-transform`,children:[t.jsxs("div",{className:`${r.color} p-4 text-center border-b-2`,children:[t.jsx("div",{className:"text-4xl mb-2",children:r.icon}),t.jsxs("p",{className:"font-bold text-lg",children:["Posici칩n ",a]})]}),t.jsxs("div",{className:"p-6 space-y-3",children:[t.jsx("h4",{className:"font-bold text-gray-900 text-sm line-clamp-2 min-h-[40px]",children:e.nombre}),t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsx("span",{className:"text-gray-600",children:"Categor칤a:"}),t.jsx("span",{className:"font-semibold text-gray-900",children:e.categoria})]}),t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsx("span",{className:"text-gray-600",children:"Cantidad:"}),t.jsxs("span",{className:"font-bold text-blue-600",children:[e.cantidad," uds"]})]}),t.jsxs("div",{className:"border-t pt-3",children:[t.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Valor en Inventario"}),t.jsx("p",{className:"text-2xl font-bold text-purple-600",children:j(e.valor_inventario)})]})]})]},e.id)})}),t.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 overflow-hidden",children:[t.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-purple-50 to-blue-50",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(x,{className:"w-6 h-6 text-purple-600"}),t.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Ranking Completo"})]})}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50 border-b-2 border-gray-200",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700 w-20",children:"Rank"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Producto"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Categor칤a"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Depto"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Cantidad"}),t.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700",children:"Costo Unit."}),t.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700",children:"Precio Venta"}),t.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700",children:"Valor Inv."}),t.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700",children:"Valor Venta"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Margen"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"% Total"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:a.products.map((e,s)=>{const a=s+1,r=u(a),l=y(e.costo_unitario,e.precio_venta),n=(e.valor_inventario/v*100).toFixed(1);return t.jsxs("tr",{className:"hover:bg-purple-50 transition-colors",children:[t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsx("span",{className:`inline-flex items-center justify-center w-10 h-10 rounded-full border-2 ${r.color} font-bold text-sm`,children:a})}),t.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900 max-w-xs truncate",children:e.nombre}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:e.categoria}),t.jsx("td",{className:"px-4 py-3",children:t.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:e.departamento})}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsx("span",{className:"inline-flex px-3 py-1 text-sm font-bold rounded-full bg-gray-100 text-gray-800",children:e.cantidad})}),t.jsx("td",{className:"px-4 py-3 text-sm text-right text-gray-700",children:j(e.costo_unitario)}),t.jsx("td",{className:"px-4 py-3 text-sm font-semibold text-right text-gray-900",children:j(e.precio_venta)}),t.jsx("td",{className:"px-4 py-3 text-sm font-bold text-right text-purple-700",children:j(e.valor_inventario)}),t.jsx("td",{className:"px-4 py-3 text-sm font-bold text-right text-green-700",children:j(e.valor_potencial_venta)}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsxs("span",{className:"inline-flex px-2 py-1 text-xs font-bold rounded-full "+(l>=20?"bg-green-100 text-green-800":l>=10?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:[l,"%"]})}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsxs("div",{className:"flex flex-col items-center gap-1",children:[t.jsx("div",{className:"w-16 h-2 bg-gray-200 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-purple-500",style:{width:`${n}%`}})}),t.jsxs("span",{className:"text-xs font-semibold text-gray-600",children:[n,"%"]})]})})]},e.id)})})]})})]})]})},R=()=>{const[e,s]=r.useState(null),[a,l]=r.useState(null),[n,o]=r.useState(!0),[c,x]=r.useState(null),[p,b]=r.useState(!0),[j,u]=r.useState(!0),N=async()=>{o(!0),x(null);try{const[e,t]=await Promise.all([E(),$()]);s(e.categories),l(t.sizes)}catch(e){x(e.message)}finally{o(!1)}};r.useEffect(()=>{N()},[]);const v=e=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),f=e=>e?e.reduce((e,s)=>e+(s.valor_inventario||0),0):0;if(n)return t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"}),t.jsx("p",{className:"mt-4 text-gray-600 font-medium",children:"Cargando an치lisis de categor칤as y tallas..."})]})});if(c)return t.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[t.jsxs("div",{className:"flex items-center gap-3 text-red-800",children:[t.jsx(i,{className:"w-6 h-6"}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold",children:"Error al cargar an치lisis"}),t.jsx("p",{className:"text-sm",children:c})]})]}),t.jsxs("button",{onClick:N,className:"mt-4 flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-all",children:[t.jsx(d,{className:"w-4 h-4"}),"Reintentar"]})]});const w=f(e),_=f(a);return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Categor칤as y Tallas"}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"An치lisis detallado por categor칤a y talla"})]}),t.jsxs("button",{onClick:N,className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-all",children:[t.jsx(d,{className:"w-4 h-4"}),"Actualizar"]})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 overflow-hidden",children:[t.jsxs("div",{className:"flex items-center justify-between p-6 bg-gradient-to-r from-blue-50 to-indigo-50 border-b border-gray-200 cursor-pointer hover:from-blue-100 hover:to-indigo-100 transition-colors",onClick:()=>b(!p),children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:t.jsx(m,{className:"w-6 h-6 text-blue-600"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"An치lisis por Categor칤a"}),t.jsxs("p",{className:"text-sm text-gray-600",children:[(null==e?void 0:e.length)||0," categor칤as - Valor total: ",v(w)]})]})]}),p?t.jsx(h,{className:"w-5 h-5 text-gray-600"}):t.jsx(g,{className:"w-5 h-5 text-gray-600"})]}),p&&e&&t.jsxs("div",{className:"p-6",children:[t.jsx("div",{className:"mb-6 space-y-3",children:e.sort((e,s)=>s.valor_inventario-e.valor_inventario).slice(0,10).map((e,s)=>{const a=w>0?e.valor_inventario/w*100:0;return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"inline-flex items-center justify-center w-6 h-6 rounded-full bg-blue-100 text-blue-700 text-xs font-bold",children:s+1}),t.jsx("span",{className:"font-semibold text-gray-900",children:e.categoria})]}),t.jsxs("span",{className:"text-sm text-gray-600",children:[a.toFixed(1),"% - ",v(e.valor_inventario)]})]}),t.jsx("div",{className:"w-full h-8 bg-gray-200 rounded-lg overflow-hidden",children:t.jsxs("div",{className:"h-full bg-gradient-to-r from-blue-500 to-indigo-500 flex items-center justify-between px-3 transition-all",style:{width:`${Math.max(a,5)}%`},children:[t.jsxs("span",{className:"text-white text-xs font-semibold",children:[e.total_items," items"]}),t.jsxs("span",{className:"text-white text-xs font-semibold",children:[e.total_unidades," uds"]})]})})]},e.categoria)})}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50 border-y border-gray-200",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"#"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Categor칤a"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Items"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Unidades"}),t.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700",children:"Valor Inventario"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"% del Total"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:e.sort((e,s)=>s.valor_inventario-e.valor_inventario).map((e,s)=>{const a=w>0?e.valor_inventario/w*100:0;return t.jsxs("tr",{className:"hover:bg-blue-50 transition-colors",children:[t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:s+1}),t.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:e.categoria}),t.jsx("td",{className:"px-4 py-3 text-sm text-center text-gray-700",children:e.total_items}),t.jsx("td",{className:"px-4 py-3 text-sm text-center font-semibold text-blue-600",children:e.total_unidades}),t.jsx("td",{className:"px-4 py-3 text-sm font-bold text-right text-gray-900",children:v(e.valor_inventario)}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsxs("span",{className:"inline-flex px-3 py-1 text-xs font-bold rounded-full bg-blue-100 text-blue-800",children:[a.toFixed(1),"%"]})})]},e.categoria)})})]})})]})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 overflow-hidden",children:[t.jsxs("div",{className:"flex items-center justify-between p-6 bg-gradient-to-r from-purple-50 to-pink-50 border-b border-gray-200 cursor-pointer hover:from-purple-100 hover:to-pink-100 transition-colors",onClick:()=>u(!j),children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:t.jsx(y,{className:"w-6 h-6 text-purple-600"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"An치lisis por Talla"}),t.jsxs("p",{className:"text-sm text-gray-600",children:[(null==a?void 0:a.length)||0," tallas - Valor total: ",v(_)]})]})]}),j?t.jsx(h,{className:"w-5 h-5 text-gray-600"}):t.jsx(g,{className:"w-5 h-5 text-gray-600"})]}),j&&a&&t.jsxs("div",{className:"p-6",children:[t.jsx("div",{className:"mb-6 space-y-3",children:a.sort((e,s)=>s.total_unidades-e.total_unidades).slice(0,15).map((e,s)=>{const r=Math.max(...a.map(e=>e.total_unidades)),l=r>0?e.total_unidades/r*100:0;return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"inline-flex items-center justify-center w-16 h-8 rounded-lg bg-purple-100 text-purple-700 text-sm font-bold border-2 border-purple-300",children:e.talla}),t.jsxs("span",{className:"text-sm text-gray-600",children:[e.cantidad_items," items diferentes"]})]}),t.jsxs("span",{className:"text-sm font-semibold text-gray-900",children:[e.total_unidades," unidades"]})]}),t.jsx("div",{className:"w-full h-6 bg-gray-200 rounded-lg overflow-hidden",children:t.jsx("div",{className:"h-full bg-gradient-to-r from-purple-500 to-pink-500 flex items-center justify-end px-3 transition-all",style:{width:`${Math.max(l,5)}%`},children:t.jsx("span",{className:"text-white text-xs font-semibold",children:v(e.valor_inventario)})})})]},e.talla)})}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50 border-y border-gray-200",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Talla"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Items Diferentes"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Total Unidades"}),t.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700",children:"Valor Inventario"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"% del Total (Valor)"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:a.sort((e,s)=>s.valor_inventario-e.valor_inventario).map(e=>{const s=_>0?e.valor_inventario/_*100:0;return t.jsxs("tr",{className:"hover:bg-purple-50 transition-colors",children:[t.jsx("td",{className:"px-4 py-3",children:t.jsx("span",{className:"inline-flex items-center justify-center min-w-[60px] px-3 py-1 rounded-lg bg-purple-100 text-purple-800 text-sm font-bold border border-purple-300",children:e.talla})}),t.jsx("td",{className:"px-4 py-3 text-sm text-center text-gray-700",children:e.cantidad_items}),t.jsx("td",{className:"px-4 py-3 text-sm text-center font-bold text-purple-600",children:e.total_unidades}),t.jsx("td",{className:"px-4 py-3 text-sm font-bold text-right text-gray-900",children:v(e.valor_inventario)}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsxs("span",{className:"inline-flex px-3 py-1 text-xs font-bold rounded-full bg-purple-100 text-purple-800",children:[s.toFixed(1),"%"]})})]},e.talla)})})]})})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-100 rounded-xl shadow-md p-6 border border-blue-200",children:[t.jsx("h4",{className:"text-sm font-semibold text-blue-900 mb-4",children:"Resumen de Categor칤as"}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-sm text-gray-700",children:"Total Categor칤as:"}),t.jsx("span",{className:"text-lg font-bold text-blue-700",children:(null==e?void 0:e.length)||0})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-sm text-gray-700",children:"Valor Total:"}),t.jsx("span",{className:"text-lg font-bold text-blue-700",children:v(w)})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-sm text-gray-700",children:"Promedio por Categor칤a:"}),t.jsx("span",{className:"text-lg font-bold text-blue-700",children:v((null==e?void 0:e.length)?w/e.length:0)})]})]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-100 rounded-xl shadow-md p-6 border border-purple-200",children:[t.jsx("h4",{className:"text-sm font-semibold text-purple-900 mb-4",children:"Resumen de Tallas"}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-sm text-gray-700",children:"Total Tallas:"}),t.jsx("span",{className:"text-lg font-bold text-purple-700",children:(null==a?void 0:a.length)||0})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-sm text-gray-700",children:"Valor Total:"}),t.jsx("span",{className:"text-lg font-bold text-purple-700",children:v(_)})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-sm text-gray-700",children:"Promedio por Talla:"}),t.jsx("span",{className:"text-lg font-bold text-purple-700",children:v((null==a?void 0:a.length)?_/a.length:0)})]})]})]})]})]})},B=()=>{const[a,d]=r.useState(!1),[o,h]=r.useState(null),[g,p]=r.useState(null),[b,j]=r.useState(null),[u,I]=r.useState("inventario-completo"),E=r.useRef(null),[$,T]=r.useState(1),[F,P]=r.useState(50),[D,V]=r.useState(""),O=e=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(e);return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-200",children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"An치lisis de Inventario"}),t.jsx("p",{className:"text-gray-600 mb-6",children:"Consulte el inventario actual desde Alegra o cargue un archivo exportado para an치lisis"}),t.jsxs("div",{className:"flex flex-wrap gap-4",children:[t.jsxs("button",{onClick:async()=>{d(!0),p(null),j(null),T(1),V("");try{const t=await(async()=>{const t="/api/inventory/analysis";try{e.info("Obteniendo an치lisis completo de inventario:",t);const a=await s(t,{},6e4);if(!a.ok){const e=await a.json().catch(()=>({}));throw new Error(e.error||"Error al obtener an치lisis completo")}const r=await a.json();return e.info("An치lisis completo obtenido exitosamente"),r}catch(g){throw e.error("Error al obtener an치lisis completo:",g.message),g}})();t.success?h(t):p("Error al obtener inventario actual")}catch(t){p(t.message||"Error al obtener inventario desde Alegra")}finally{d(!1)}},disabled:a,className:"flex items-center gap-2 px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-md",children:[t.jsx(n,{className:"w-5 h-5"}),"Ver Inventario Actual"]}),t.jsxs("button",{onClick:()=>{var e;null==(e=E.current)||e.click()},disabled:a,className:"flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-md",children:[t.jsx(v,{className:"w-5 h-5"}),"Cargar Archivo de Inventario"]}),t.jsx("input",{ref:E,type:"file",accept:".csv,.xlsx,.xls",onChange:async t=>{const a=t.target.files[0];if(!a)return;const r="."+a.name.split(".").pop().toLowerCase();if([".csv",".xlsx",".xls"].includes(r)){d(!0),p(null),j(a.name),T(1),V("");try{const t=await(async t=>{try{e.info("Subiendo archivo de inventario:",t.name);const a=new FormData;a.append("file",t);const r=await s("/api/inventory/upload-file",{method:"POST",body:a},6e4);if(!r.ok){const e=await r.json().catch(()=>({}));throw new Error(e.error||"Error al procesar el archivo")}const l=await r.json();return e.info("Archivo procesado exitosamente"),l}catch(g){throw e.error("Error al subir archivo de inventario:",g.message),g}})(a);t.success?h(t):p("Error al procesar el archivo")}catch(l){p(l.message||"Error al cargar el archivo")}finally{d(!1),E.current&&(E.current.value="")}}else p("Formato no soportado. Use CSV o Excel (.csv, .xlsx, .xls)")},style:{display:"none"}})]}),b&&t.jsxs("div",{className:"mt-4 flex items-center gap-2 text-sm text-gray-600",children:[t.jsx(f,{className:"w-4 h-4"}),t.jsxs("span",{children:["Archivo: ",t.jsx("strong",{children:b})]})]})]}),a&&t.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-semibold text-blue-900",children:"Procesando..."}),t.jsx("p",{className:"text-sm text-blue-700",children:b?"Analizando archivo de inventario":"Consultando inventario desde Alegra"})]})]})}),g&&t.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-6",children:t.jsxs("div",{className:"flex items-center gap-3 text-red-800",children:[t.jsx(i,{className:"w-6 h-6"}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold",children:"Error"}),t.jsx("p",{className:"text-sm",children:g})]})]})}),o&&!a&&t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4",children:t.jsxs("div",{className:"flex items-center gap-2 text-green-800",children:[t.jsx(w,{className:"w-5 h-5"}),t.jsx("p",{className:"font-semibold",children:"An치lisis completado exitosamente"})]})}),o.tipo_archivo&&t.jsx("div",{className:"rounded-xl p-4 border "+("inventario_alegra"===o.tipo_archivo?"bg-blue-50 border-blue-200":"bg-purple-50 border-purple-200"),children:t.jsxs("div",{className:"flex items-center gap-2 "+("inventario_alegra"===o.tipo_archivo?"text-blue-800":"text-purple-800"),children:[t.jsx(l,{className:"w-5 h-5"}),t.jsx("p",{className:"font-semibold",children:"inventario_alegra"===o.tipo_archivo?"游닍 Archivo de inventario detectado - Incluye cantidades en stock":"游늶 Archivo de exportaci칩n detectado - Cat치logo de productos"})]})}),t.jsx("div",{className:"bg-white rounded-xl shadow-md p-4 border border-gray-200",children:t.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-thin scrollbar-thumb-gray-300",children:[{id:"inventario-completo",label:"Inventario Completo",icon:_},{id:"resumen",label:"Resumen General",icon:C},{id:"departamentos",label:"Departamentos",icon:m},{id:"top-productos",label:"Top Categor칤as",icon:N},{id:"categorias",label:"Todas las Categor칤as",icon:y}].map(e=>{const s=e.icon,a=u===e.id;return t.jsxs("button",{onClick:()=>I(e.id),className:"flex items-center gap-2 px-4 py-2.5 rounded-lg whitespace-nowrap transition-all "+(a?"bg-blue-600 text-white shadow-md":"bg-gray-50 text-gray-700 hover:bg-blue-50 hover:text-blue-700 border border-gray-200"),children:[t.jsx(s,{className:"w-4 h-4 "+(a?"text-white":"text-gray-600")}),t.jsx("span",{className:"text-sm font-semibold",children:e.label})]},e.id)})})}),function(){switch(u){case"inventario-completo":default:return M();case"resumen":return function(){var e,s,a,r,n,d,m,h,g,p,b;const j="inventario_alegra"===o.tipo_archivo,u="exportacion_productos"===o.tipo_archivo;return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-200",children:[t.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:"Resumen General"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[t.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg shadow p-4 border border-blue-200",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-blue-700 font-medium",children:"Total Items"}),t.jsx("p",{className:"text-3xl font-bold text-blue-900 mt-1",children:(null==(e=o.resumen_general)?void 0:e.total_items)||0})]}),t.jsx("div",{className:"p-3 bg-blue-200 rounded-lg",children:t.jsx(l,{className:"w-6 h-6 text-blue-700"})})]})}),j&&void 0!==(null==(s=o.resumen_general)?void 0:s.total_unidades)&&t.jsx("div",{className:"bg-gradient-to-br from-cyan-50 to-cyan-100 rounded-lg shadow p-4 border border-cyan-200",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-cyan-700 font-medium",children:"Total Unidades"}),t.jsx("p",{className:"text-3xl font-bold text-cyan-900 mt-1",children:o.resumen_general.total_unidades.toLocaleString()})]}),t.jsx("div",{className:"p-3 bg-cyan-200 rounded-lg",children:t.jsx(l,{className:"w-6 h-6 text-cyan-700"})})]})}),t.jsx("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-lg shadow p-4 border border-green-200",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-green-700 font-medium",children:"Valor Inventario"}),t.jsx("p",{className:"text-2xl font-bold text-green-900 mt-1",children:O((null==(a=o.resumen_general)?void 0:a.valor_total_inventario)||(null==(r=o.resumen_general)?void 0:r.valor_total_precio)||0)})]}),t.jsx("div",{className:"p-3 bg-green-200 rounded-lg",children:t.jsx(c,{className:"w-6 h-6 text-green-700"})})]})}),j&&void 0!==(null==(n=o.resumen_general)?void 0:n.items_activos)&&t.jsx("div",{className:"bg-gradient-to-br from-emerald-50 to-emerald-100 rounded-lg shadow p-4 border border-emerald-200",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-emerald-700 font-medium",children:"Productos Activos"}),t.jsx("p",{className:"text-3xl font-bold text-emerald-900 mt-1",children:o.resumen_general.items_activos.toLocaleString()})]}),t.jsx("div",{className:"p-3 bg-emerald-200 rounded-lg",children:t.jsx(w,{className:"w-6 h-6 text-emerald-700"})})]})}),j&&void 0!==(null==(d=o.resumen_general)?void 0:d.items_inactivos)&&t.jsx("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-lg shadow p-4 border border-gray-200",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-700 font-medium",children:"Productos Inactivos"}),t.jsx("p",{className:"text-3xl font-bold text-gray-900 mt-1",children:o.resumen_general.items_inactivos.toLocaleString()})]}),t.jsx("div",{className:"p-3 bg-gray-200 rounded-lg",children:t.jsx(i,{className:"w-6 h-6 text-gray-700"})})]})}),u&&void 0!==(null==(m=o.resumen_general)?void 0:m.margen_total)&&t.jsx("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg shadow p-4 border border-purple-200",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-purple-700 font-medium",children:"Margen Total"}),t.jsx("p",{className:"text-2xl font-bold text-purple-900 mt-1",children:O(o.resumen_general.margen_total)})]}),t.jsx("div",{className:"p-3 bg-purple-200 rounded-lg",children:t.jsx(x,{className:"w-6 h-6 text-purple-700"})})]})}),u&&void 0!==(null==(h=o.resumen_general)?void 0:h.margen_porcentaje)&&t.jsx("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 rounded-lg shadow p-4 border border-orange-200",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-orange-700 font-medium",children:"Margen %"}),t.jsxs("p",{className:"text-3xl font-bold text-orange-900 mt-1",children:[o.resumen_general.margen_porcentaje.toFixed(2),"%"]})]}),t.jsx("div",{className:"p-3 bg-orange-200 rounded-lg",children:t.jsx(x,{className:"w-6 h-6 text-orange-700"})})]})}),t.jsx("div",{className:"bg-gradient-to-br from-indigo-50 to-indigo-100 rounded-lg shadow p-4 border border-indigo-200",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-indigo-700 font-medium",children:"Total Categor칤as"}),t.jsx("p",{className:"text-3xl font-bold text-indigo-900 mt-1",children:(null==(g=o.resumen_general)?void 0:g.total_categorias)||0})]}),t.jsx("div",{className:"p-3 bg-indigo-200 rounded-lg",children:t.jsx(f,{className:"w-6 h-6 text-indigo-700"})})]})}),t.jsx("div",{className:"bg-gradient-to-br from-pink-50 to-pink-100 rounded-lg shadow p-4 border border-pink-200",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-pink-700 font-medium",children:"Valor Costo"}),t.jsx("p",{className:"text-2xl font-bold text-pink-900 mt-1",children:O((null==(p=o.resumen_general)?void 0:p.costo_total_inventario)||(null==(b=o.resumen_general)?void 0:b.valor_total_costo)||0)})]}),t.jsx("div",{className:"p-3 bg-pink-200 rounded-lg",children:t.jsx(c,{className:"w-6 h-6 text-pink-700"})})]})})]})]}),o.departamentos_ordenados&&o.departamentos_ordenados.length>0&&t.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-200",children:[t.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:"Departamentos por Valor"}),t.jsx("div",{className:"space-y-3",children:o.departamentos_ordenados.map((e,s)=>t.jsxs("div",{className:"relative",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"font-semibold text-gray-800 capitalize",children:e.nombre}),t.jsxs("div",{className:"text-right",children:[t.jsxs("p",{className:"text-sm text-gray-600",children:[e.cantidad," items"]}),t.jsx("p",{className:"font-bold text-gray-900",children:O(e.valor)})]})]}),t.jsx("div",{className:"h-3 bg-gray-200 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 to-blue-600 rounded-full transition-all",style:{width:e.valor/o.departamentos_ordenados[0].valor*100+"%"}})})]},s))})]})]})}();case"departamentos":return function(){if(!o.por_departamento)return t.jsx("div",{className:"text-center py-12 text-gray-500",children:"No hay datos de departamentos disponibles en el archivo cargado"});const e="inventario_alegra"===o.tipo_archivo;return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-200",children:[t.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:"An치lisis Detallado por Departamento"}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full border-collapse",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-gray-100 border-b-2 border-gray-300",children:[t.jsx("th",{className:"text-left p-3 font-semibold text-gray-700",children:"Departamento"}),t.jsx("th",{className:"text-right p-3 font-semibold text-gray-700",children:"Items"}),e&&t.jsx("th",{className:"text-right p-3 font-semibold text-gray-700",children:"Unidades"}),t.jsx("th",{className:"text-right p-3 font-semibold text-gray-700",children:"Valor Costo"}),t.jsxs("th",{className:"text-right p-3 font-semibold text-gray-700",children:["Valor ",e?"Inventario":"Precio"]}),!e&&t.jsxs(t.Fragment,{children:[t.jsx("th",{className:"text-right p-3 font-semibold text-gray-700",children:"Margen $"}),t.jsx("th",{className:"text-right p-3 font-semibold text-gray-700",children:"Margen %"})]}),t.jsx("th",{className:"text-right p-3 font-semibold text-gray-700",children:"% Inventario"})]})}),t.jsx("tbody",{children:Object.entries(o.por_departamento).map(([s,a])=>{var r;return t.jsxs("tr",{className:"border-b border-gray-200 hover:bg-gray-50 transition-colors",children:[t.jsx("td",{className:"p-3 font-semibold text-gray-900 capitalize",children:s}),t.jsx("td",{className:"text-right p-3 text-gray-700",children:a.cantidad_items||a.cantidad||0}),e&&t.jsx("td",{className:"text-right p-3 text-blue-700 font-semibold",children:(null==(r=a.cantidad_unidades)?void 0:r.toLocaleString())||0}),t.jsx("td",{className:"text-right p-3 text-gray-700",children:O(a.costo_total||a.valor_costo||0)}),t.jsx("td",{className:"text-right p-3 text-gray-700",children:O(a.valor_inventario||a.valor_precio||0)}),!e&&void 0!==a.margen_total&&t.jsxs(t.Fragment,{children:[t.jsx("td",{className:"text-right p-3 text-green-700 font-semibold",children:O(a.margen_total)}),t.jsx("td",{className:"text-right p-3",children:t.jsxs("span",{className:"px-2 py-1 rounded-full text-sm font-semibold "+(a.margen_porcentaje>=20?"bg-green-100 text-green-700":a.margen_porcentaje>=10?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"),children:[a.margen_porcentaje.toFixed(2),"%"]})})]}),t.jsxs("td",{className:"text-right p-3 text-gray-700",children:[(a.porcentaje_unidades||a.porcentaje_inventario||a.porcentaje_valor||0).toFixed(2),"%"]})]},s)})})]})})]}),o.departamentos_ordenados&&o.departamentos_ordenados.length>0&&t.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-200",children:[t.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:"Distribuci칩n por Valor"}),t.jsx("div",{className:"space-y-3",children:o.departamentos_ordenados.map((e,s)=>t.jsxs("div",{className:"relative",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"font-semibold text-gray-800 capitalize",children:e.nombre}),t.jsxs("div",{className:"text-right",children:[t.jsxs("p",{className:"text-sm text-gray-600",children:[e.cantidad," items"]}),t.jsx("p",{className:"font-bold text-gray-900",children:O(e.valor)})]})]}),t.jsx("div",{className:"h-3 bg-gray-200 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-gradient-to-r from-teal-500 to-teal-600 rounded-full transition-all",style:{width:e.valor/o.departamentos_ordenados[0].valor*100+"%"}})})]},s))})]})]})}();case"top-productos":return function(){if(!o.top_categorias||0===o.top_categorias.length)return t.jsx("div",{className:"text-center py-12 text-gray-500",children:"No hay datos de categor칤as disponibles en el archivo cargado"});return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-200",children:[t.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:"Top 20 Categor칤as"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:o.top_categorias.slice(0,20).map((e,s)=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg border border-gray-200 hover:bg-gray-100 transition-colors",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-blue-100 text-blue-700 rounded-full font-bold text-sm",children:s+1}),t.jsx("span",{className:"font-semibold text-gray-800",children:e.categoria})]}),t.jsxs("span",{className:"text-gray-600 font-semibold",children:[e.cantidad," items"]})]},s))})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-200",children:[t.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:"Distribuci칩n Visual"}),t.jsx("div",{className:"space-y-3",children:o.top_categorias.slice(0,10).map((e,s)=>{const a=o.top_categorias[0].cantidad,r=e.cantidad/a*100;return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"inline-flex items-center justify-center w-6 h-6 rounded-full bg-purple-100 text-purple-700 text-xs font-bold",children:s+1}),t.jsx("span",{className:"font-semibold text-gray-900",children:e.categoria})]}),t.jsxs("span",{className:"text-sm text-gray-600",children:[e.cantidad," items"]})]}),t.jsx("div",{className:"w-full h-8 bg-gray-200 rounded-lg overflow-hidden",children:t.jsx("div",{className:"h-full bg-gradient-to-r from-purple-500 to-purple-600 flex items-center justify-end px-3 transition-all",style:{width:`${Math.max(r,5)}%`},children:t.jsxs("span",{className:"text-white text-xs font-semibold",children:[r.toFixed(1),"%"]})})})]},s)})})]})]})}();case"categorias":return function(){if(!o.top_categorias||0===o.top_categorias.length)return t.jsx("div",{className:"text-center py-12 text-gray-500",children:"No hay datos de categor칤as disponibles en el archivo cargado"});return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 to-purple-100 rounded-xl shadow-md p-6 border border-indigo-200",children:[t.jsx("h4",{className:"text-sm font-semibold text-indigo-900 mb-4",children:"Resumen de Categor칤as"}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-700",children:"Total Categor칤as:"}),t.jsx("span",{className:"ml-2 text-lg font-bold text-indigo-700",children:o.top_categorias.length})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-700",children:"Total Items:"}),t.jsx("span",{className:"ml-2 text-lg font-bold text-indigo-700",children:o.top_categorias.reduce((e,s)=>e+s.cantidad,0)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-700",children:"Promedio por Categor칤a:"}),t.jsx("span",{className:"ml-2 text-lg font-bold text-indigo-700",children:(o.top_categorias.reduce((e,s)=>e+s.cantidad,0)/o.top_categorias.length).toFixed(1)})]})]})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 overflow-hidden",children:[t.jsx("div",{className:"p-6 border-b border-gray-200",children:t.jsxs("h3",{className:"text-lg font-bold text-gray-900",children:["Todas las Categor칤as (",o.top_categorias.length,")"]})}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50 border-y border-gray-200",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"#"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Categor칤a"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Items"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"% del Total"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:o.top_categorias.map((e,s)=>{const a=o.top_categorias.reduce((e,s)=>e+s.cantidad,0),r=e.cantidad/a*100;return t.jsxs("tr",{className:"hover:bg-indigo-50 transition-colors",children:[t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:s+1}),t.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:e.categoria}),t.jsx("td",{className:"px-4 py-3 text-sm text-center font-semibold text-indigo-600",children:e.cantidad}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx("div",{className:"w-24 h-2 bg-gray-200 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-indigo-500",style:{width:`${r}%`}})}),t.jsxs("span",{className:"text-xs font-semibold text-gray-600",children:[r.toFixed(1),"%"]})]})})]},s)})})]})})]})]})}()}}()]})]});function M(){if(!o.items_completos||0===o.items_completos.length)return t.jsxs("div",{className:"text-center py-12 text-gray-500",children:[t.jsx(i,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),t.jsx("p",{className:"text-lg font-semibold",children:"No hay datos de inventario completo disponibles"}),t.jsx("p",{className:"text-sm mt-2",children:"El archivo no contiene items completos o el formato no es compatible"})]});const e=o.items_completos,s=D?e.filter(e=>e.item.toLowerCase().includes(D.toLowerCase())||e.categoria.toLowerCase().includes(D.toLowerCase())):e,a=s.length,r=Math.ceil(a/F),l=($-1)*F,n=l+F,d=s.slice(l,n),c=e.reduce((e,s)=>e+(s.cantidad||0),0),x=e.reduce((e,s)=>e+(s.total||0),0),m=x/c;return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 to-blue-100 rounded-xl shadow-md p-6 border border-indigo-200",children:[t.jsx("h3",{className:"text-2xl font-bold text-indigo-900 mb-4",children:"游늶 Inventario Completo - Todos los Items"}),t.jsx("p",{className:"text-indigo-700 mb-6",children:"Listado completo de todos los art칤culos en inventario con detalles individuales"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"bg-white/80 rounded-lg p-4 border border-indigo-200",children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Total Items"}),t.jsx("p",{className:"text-2xl font-bold text-indigo-900",children:e.length.toLocaleString()})]}),t.jsxs("div",{className:"bg-white/80 rounded-lg p-4 border border-indigo-200",children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Total Unidades"}),t.jsx("p",{className:"text-2xl font-bold text-indigo-900",children:c.toLocaleString()})]}),t.jsxs("div",{className:"bg-white/80 rounded-lg p-4 border border-indigo-200",children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Valor Total"}),t.jsx("p",{className:"text-xl font-bold text-indigo-900",children:O(x)})]}),t.jsxs("div",{className:"bg-white/80 rounded-lg p-4 border border-indigo-200",children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Costo Promedio"}),t.jsx("p",{className:"text-xl font-bold text-indigo-900",children:O(m)})]})]})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-md p-4 border border-gray-200",children:[t.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:[t.jsxs("div",{className:"relative flex-1 w-full md:w-auto",children:[t.jsx(k,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),t.jsx("input",{type:"text",placeholder:"Buscar por item o categor칤a...",value:D,onChange:e=>{V(e.target.value),T(1)},className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("label",{className:"text-sm text-gray-600 whitespace-nowrap",children:"Items por p치gina:"}),t.jsxs("select",{value:F,onChange:e=>{P(Number(e.target.value)),T(1)},className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500",children:[t.jsx("option",{value:25,children:"25"}),t.jsx("option",{value:50,children:"50"}),t.jsx("option",{value:100,children:"100"}),t.jsx("option",{value:200,children:"200"})]})]})]}),t.jsxs("div",{className:"mt-3 text-sm text-gray-600",children:["Mostrando ",l+1," - ",Math.min(n,a)," de ",a.toLocaleString()," items",D&&` (filtrado de ${e.length.toLocaleString()} items totales)`]})]}),t.jsx("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full border-collapse",children:[t.jsx("thead",{className:"bg-gradient-to-r from-indigo-600 to-blue-600 text-white",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-left p-4 font-semibold",children:"#"}),t.jsx("th",{className:"text-left p-4 font-semibold",children:"Item"}),t.jsx("th",{className:"text-left p-4 font-semibold",children:"Categor칤a"}),t.jsx("th",{className:"text-right p-4 font-semibold",children:"Cantidad"}),t.jsx("th",{className:"text-right p-4 font-semibold",children:"Costo Promedio"}),t.jsx("th",{className:"text-right p-4 font-semibold",children:"Total"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:d.map((e,s)=>{const a=l+s+1;return t.jsxs("tr",{className:"hover:bg-indigo-50 transition-colors",children:[t.jsx("td",{className:"p-4 text-sm text-gray-600 font-medium",children:a}),t.jsx("td",{className:"p-4",children:t.jsx("p",{className:"text-sm font-semibold text-gray-900",children:e.item})}),t.jsx("td",{className:"p-4",children:t.jsx("span",{className:"inline-block px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-semibold",children:e.categoria})}),t.jsx("td",{className:"p-4 text-right",children:t.jsx("span",{className:"inline-block px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-bold",children:e.cantidad.toLocaleString()})}),t.jsx("td",{className:"p-4 text-right text-sm font-semibold text-gray-900",children:O(e.costo_promedio)}),t.jsx("td",{className:"p-4 text-right text-sm font-bold text-indigo-700",children:O(e.total)})]},s)})})]})})}),r>1&&t.jsxs("div",{className:"bg-white rounded-xl shadow-md p-4 border border-gray-200",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("button",{onClick:()=>T(e=>Math.max(e-1,1)),disabled:1===$,className:"flex items-center gap-2 px-4 py-2 rounded-lg font-semibold transition-all "+(1===$?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-indigo-600 text-white hover:bg-indigo-700"),children:[t.jsx(A,{className:"w-4 h-4"}),"Anterior"]}),t.jsxs("div",{className:"flex items-center gap-2",children:[$>3&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>T(1),className:"w-10 h-10 rounded-lg bg-gray-100 hover:bg-indigo-100 text-gray-700 font-semibold transition-all",children:"1"}),$>4&&t.jsx("span",{className:"text-gray-400",children:"..."})]}),Array.from({length:Math.min(5,r)},(e,s)=>{const a=Math.max(1,Math.min($-2,r-4))+s;return a<=r?t.jsx("button",{onClick:()=>T(a),className:"w-10 h-10 rounded-lg font-semibold transition-all "+($===a?"bg-indigo-600 text-white":"bg-gray-100 hover:bg-indigo-100 text-gray-700"),children:a},a):null}),$<r-2&&t.jsxs(t.Fragment,{children:[$<r-3&&t.jsx("span",{className:"text-gray-400",children:"..."}),t.jsx("button",{onClick:()=>T(r),className:"w-10 h-10 rounded-lg bg-gray-100 hover:bg-indigo-100 text-gray-700 font-semibold transition-all",children:r})]})]}),t.jsxs("button",{onClick:()=>T(e=>Math.min(e+1,r)),disabled:$===r,className:"flex items-center gap-2 px-4 py-2 rounded-lg font-semibold transition-all "+($===r?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-indigo-600 text-white hover:bg-indigo-700"),children:["Siguiente",t.jsx(S,{className:"w-4 h-4"})]})]}),t.jsxs("div",{className:"mt-3 text-center text-sm text-gray-600",children:["P치gina ",$," de ",r]})]})]})}},L=()=>{const[e,s]=r.useState("cargar-archivo"),[i,d]=r.useState("dashboard");a((()=>{if("cargar-archivo"===e)return"Inventario - Cargar Archivo";switch(i){case"dashboard":return"Inventario - Dashboard";case"departamentos":return"Inventario - Departamentos";case"alertas":return"Inventario - Alertas de Stock";case"abc":return"Inventario - An치lisis ABC";case"top-productos":return"Inventario - Top Productos";case"categorias-tallas":return"Inventario - Categor칤as y Tallas";default:return"Inventario"}})());const o=[{id:"cargar-archivo",label:"Cargar Archivo",icon:v,description:"An치lisis de archivo"},{id:"analisis",label:"An치lisis de Inventario",icon:n,description:"Consultar inventario actual"}],c=[{id:"dashboard",label:"Dashboard",icon:C,description:"Resumen ejecutivo"},{id:"departamentos",label:"Departamentos",icon:m,description:"Por departamento"},{id:"alertas",label:"Alertas de Stock",icon:p,description:"Stock bajo y sin stock"},{id:"abc",label:"An치lisis ABC",icon:u,description:"Clasificaci칩n Pareto"},{id:"top-productos",label:"Top Productos",icon:x,description:"Mayor valor"},{id:"categorias-tallas",label:"Categor칤as y Tallas",icon:y,description:"An치lisis detallado"}];return t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"bg-white rounded-xl shadow-md p-6 border-l-4 border-teal-500",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"p-3 bg-teal-100 rounded-lg",children:t.jsx(l,{className:"w-8 h-8 text-teal-600"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"An치lisis de Inventario"}),t.jsx("p",{className:"text-sm text-gray-600",children:"Gesti칩n y an치lisis de inventario desde Alegra"})]})]})}),t.jsx("div",{className:"bg-white rounded-xl shadow-md p-4 border border-gray-200",children:t.jsx("div",{className:"flex gap-3",children:o.map(a=>{const r=a.icon,l=e===a.id;return t.jsxs("button",{onClick:()=>{return e=a.id,s(e),void("analisis"===e&&d("dashboard"));var e},className:"flex items-center gap-2 px-6 py-3 rounded-lg whitespace-nowrap transition-all flex-1 "+(l?"bg-teal-600 text-white shadow-lg transform scale-105":"bg-gray-50 text-gray-700 hover:bg-teal-50 hover:text-teal-700 border border-gray-200"),children:[t.jsx(r,{className:"w-5 h-5 "+(l?"text-white":"text-gray-600")}),t.jsxs("div",{className:"text-left",children:[t.jsx("div",{className:"text-base font-bold "+(l?"text-white":"text-gray-900"),children:a.label}),t.jsx("div",{className:"text-xs "+(l?"text-teal-100":"text-gray-500"),children:a.description})]})]},a.id)})})}),"analisis"===e&&t.jsx("div",{className:"bg-white rounded-xl shadow-md p-4 border border-gray-200",children:t.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-thin scrollbar-thumb-gray-300",children:c.map(e=>{const s=e.icon,a=i===e.id;return t.jsxs("button",{onClick:()=>d(e.id),className:"flex items-center gap-2 px-4 py-2.5 rounded-lg whitespace-nowrap transition-all "+(a?"bg-teal-600 text-white shadow-md":"bg-gray-50 text-gray-700 hover:bg-teal-50 hover:text-teal-700 border border-gray-200"),children:[t.jsx(s,{className:"w-4 h-4 "+(a?"text-white":"text-gray-600")}),t.jsxs("div",{className:"text-left",children:[t.jsx("div",{className:"text-sm font-semibold "+(a?"text-white":"text-gray-900"),children:e.label}),t.jsx("div",{className:"text-xs "+(a?"text-teal-100":"text-gray-500"),children:e.description})]})]},e.id)})})}),t.jsx("div",{children:(()=>{if("cargar-archivo"===e)return t.jsx(B,{});switch(i){case"dashboard":default:return t.jsx(P,{});case"departamentos":return t.jsx(D,{});case"alertas":return t.jsx(V,{});case"abc":return t.jsx(O,{});case"top-productos":return t.jsx(M,{});case"categorias-tallas":return t.jsx(R,{})}})()})]})};export{L as default};
