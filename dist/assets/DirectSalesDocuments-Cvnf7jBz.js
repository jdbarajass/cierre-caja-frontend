import{a as e,g as s,j as t}from"./index-BEGF0Y_h.js";import{r as a}from"./react-vendor-CfGu_lG-.js";import{b as r}from"./directApiService-D7yvDYzn.js";import{F as l,C as d,A as n,i,U as c,O as o,Q as x}from"./icons-B-eCD-Im.js";const m=()=>{e("Documentos de Venta - Estadísticas Avanzadas");const[m,u]=a.useState(!1),[h,g]=a.useState(null),[p,b]=a.useState([]),[j,y]=a.useState(null),[N,f]=a.useState(s()),[v,w]=a.useState(s()),[C,k]=a.useState(30),[S,D]=a.useState(0);a.useEffect(()=>{N&&v&&(async()=>{u(!0),g(null);try{const e={from:N,to:v,limit:C,start:S},s=await r(e);if(!s.success)throw new Error(s.error||"Error al obtener documentos de ventas");b(s.data||[]),y(s.metadata||null)}catch(e){g(e.message),b([]),y(null)}finally{u(!1)}})()},[N,v,C,S]);const A=e=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(e||0),E=e=>{if(!e)return"-";return new Date(e).toLocaleDateString("es-CO",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})},F=p.reduce((e,s)=>e+(s.total||0),0);return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-600 rounded-xl shadow-lg p-6 text-white",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[t.jsx(l,{className:"w-8 h-8"}),t.jsx("h1",{className:"text-2xl font-bold",children:"Documentos de Venta"})]}),t.jsx("p",{className:"text-blue-50",children:"Consulta detallada de facturas y documentos de ventas"})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[t.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Filtros"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[t.jsx(d,{className:"w-4 h-4 inline mr-1"}),"Desde"]}),t.jsx("input",{type:"date",value:N,onChange:e=>{f(e.target.value),D(0)},max:v,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[t.jsx(d,{className:"w-4 h-4 inline mr-1"}),"Hasta"]}),t.jsx("input",{type:"date",value:v,onChange:e=>{w(e.target.value),D(0)},min:N,max:s(),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Documentos por página"}),t.jsxs("select",{value:C,onChange:e=>{k(Number(e.target.value)),D(0)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[t.jsx("option",{value:10,children:"10 documentos"}),t.jsx("option",{value:30,children:"30 documentos"}),t.jsx("option",{value:50,children:"50 documentos"}),t.jsx("option",{value:100,children:"100 documentos"})]})]})]}),!m&&p.length>0&&t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4 pt-4 border-t border-gray-200",children:[t.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Total Documentos"}),t.jsx("p",{className:"text-2xl font-bold text-blue-600",children:p.length})]}),t.jsxs("div",{className:"bg-green-50 p-3 rounded-lg",children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Total Ventas"}),t.jsx("p",{className:"text-2xl font-bold text-green-600",children:A(F)})]})]})]}),h&&t.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-start gap-3",children:[t.jsx(n,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold text-red-800",children:"Error al cargar documentos"}),t.jsx("p",{className:"text-red-600 text-sm mt-1",children:h})]})]}),m&&t.jsxs("div",{className:"bg-white rounded-xl shadow-md p-12 text-center",children:[t.jsx(i,{className:"w-12 h-12 text-blue-600 animate-spin mx-auto mb-4"}),t.jsx("p",{className:"text-gray-600",children:"Cargando documentos de venta..."})]}),!m&&!h&&p.length>0&&t.jsxs("div",{className:"bg-white rounded-xl shadow-md overflow-hidden",children:[t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID / Número"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fecha"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cliente"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Vendedor"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estado"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:p.map((e,s)=>{var a,r,l,d,n;return t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[t.jsxs("div",{className:"text-sm font-medium text-gray-900",children:["#",(null==(a=e.number_template)?void 0:a.number)||e.id]}),(null==(r=e.number_template)?void 0:r.id)&&t.jsxs("div",{className:"text-xs text-gray-500",children:["ID: ",e.id]})]}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:E(e.date)}),t.jsx("td",{className:"px-6 py-4 text-sm",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(c,{className:"w-4 h-4 text-gray-400"}),t.jsxs("div",{children:[t.jsx("div",{className:"text-gray-900 font-medium",children:(null==(l=e.client)?void 0:l.name)||"Cliente sin nombre"}),(null==(d=e.client)?void 0:d.identification)&&t.jsx("div",{className:"text-xs text-gray-500",children:e.client.identification})]})]})}),t.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:(null==(n=e.seller)?void 0:n.name)||"-"}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-green-600 font-semibold",children:A(e.total)}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium "+("open"===e.status?"bg-green-100 text-green-800":"closed"===e.status?"bg-gray-100 text-gray-800":"bg-yellow-100 text-yellow-800"),children:"open"===e.status?"Abierto":"closed"===e.status?"Cerrado":e.status})})]},e.id||s)})}),t.jsx("tfoot",{className:"bg-gray-50 border-t-2 border-gray-300",children:t.jsxs("tr",{children:[t.jsxs("td",{colSpan:"4",className:"px-6 py-4 text-sm font-bold text-gray-900",children:["TOTAL (",p.length," documentos)"]}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-green-600 font-bold",children:A(F)}),t.jsx("td",{})]})})]})}),t.jsxs("div",{className:"bg-gray-50 px-6 py-4 border-t border-gray-200 flex items-center justify-between",children:[t.jsxs("div",{className:"text-sm text-gray-600",children:["Mostrando desde el resultado ",S+1,j&&j.total_items&&` de ${j.total_items} totales`]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("button",{onClick:()=>{D(e=>Math.max(0,e-C))},disabled:0===S,className:"px-4 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[t.jsx(o,{className:"w-4 h-4"}),"Anterior"]}),t.jsxs("button",{onClick:()=>{D(e=>e+C)},disabled:p.length<C,className:"px-4 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:["Siguiente",t.jsx(x,{className:"w-4 h-4"})]})]})]})]}),!m&&!h&&0===p.length&&t.jsxs("div",{className:"bg-white rounded-xl shadow-md p-12 text-center",children:[t.jsx(l,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No se encontraron documentos"}),t.jsx("p",{className:"text-gray-600",children:"No hay documentos de venta para el rango de fechas seleccionado"})]})]})};export{m as default};
